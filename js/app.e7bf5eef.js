(function(){"use strict";var e={4108:function(e,t,r){var o=r(2027),a=r.n(o),i=r(2856),s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"app-container"},[t("Header",{attrs:{folders:e.folders},on:{search:e.handleSearch,"add-bookmark":e.showAddBookmarkDialog,"add-folder":e.showAddFolderDialog,importBookmarks:e.showImportDialog,exportBookmarks:e.showExportDialog,checkInvalid:e.checkInvalidBookmarks,checkDuplicate:e.checkDuplicateBookmarks,resetAll:e.showResetConfirmation,"navigate-by-path":e.navigateByPath,"search-paths":e.searchPaths,"navigate-to-folder":e.handleFolderSelected}}),t("div",{staticClass:"main-content"},[t("div",{staticClass:"sidebar-container",style:{width:e.sidebarWidth+"px"}},[t("Sidebar",{on:{"folder-selected":e.handleFolderSelected,"add-bookmark":e.showAddBookmarkDialog,"custom-sort-folder":e.showCustomSortFolderDialog,"show-special-folder":e.handleSpecialFolderSelected}})],1),t("div",{staticClass:"resizer",on:{mousedown:e.initResize}}),t("div",{staticClass:"content-container"},[t("BookmarkList",{attrs:{"current-folder-id":e.currentFolderId,"special-mode":e.specialMode},on:{"folder-selected":e.handleFolderSelected}})],1)])],1),t("AddBookmarkDialog",{attrs:{visible:e.addBookmarkDialogVisible,"initial-folder-id":e.currentFolderId},on:{"update:visible":function(t){e.addBookmarkDialogVisible=t}}}),t("el-dialog",{attrs:{title:"新建文件夹",visible:e.addFolderDialogVisible,width:"400px"},on:{"update:visible":function(t){e.addFolderDialogVisible=t}}},[t("el-form",{ref:"folderForm",attrs:{model:e.folderForm,rules:e.folderRules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{model:{value:e.folderForm.name,callback:function(t){e.$set(e.folderForm,"name",t)},expression:"folderForm.name"}})],1),t("el-form-item",{attrs:{label:"父文件夹"}},[t("el-select",{attrs:{placeholder:"请选择父文件夹"},model:{value:e.folderForm.parentId,callback:function(t){e.$set(e.folderForm,"parentId",t)},expression:"folderForm.parentId"}},e._l(e.folderOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addFolderDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.createFolder}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"自定义文件夹排序",visible:e.customSortFolderDialogVisible,width:"600px"},on:{"update:visible":function(t){e.customSortFolderDialogVisible=t}}},[t("div",{staticClass:"custom-sort-content"},[t("p",[e._v("请输入自定义排序函数（JavaScript）：")]),t("p",{staticClass:"sort-instruction"},[t("small",[e._v("• 支持函数体格式："),t("code",[e._v("return a.name.localeCompare(b.name)")])]),t("br"),t("small",[e._v("• 支持箭头函数格式："),t("code",[e._v("(a, b) => a.name.localeCompare(b.name)")])]),t("br"),t("small",[e._v("• 参数a、b代表要比较的两个书签对象")])]),t("el-input",{attrs:{type:"textarea",rows:8,placeholder:"例如：return a.name.localeCompare(b.name)"},model:{value:e.customSortFolderFunction,callback:function(t){e.customSortFolderFunction=t},expression:"customSortFolderFunction"}}),t("div",{staticClass:"example-section"},[t("p",[e._v("示例：")]),t("pre",[e._v("// 按名称的字符长度排序\nreturn a.name.length - b.name.length;\n\n// 按名称的拼音首字母排序\nreturn a.name.localeCompare(b.name, 'zh-CN');\n\n// 按创建时间排序\nreturn new Date(a.createdAt) - new Date(b.createdAt);")])])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.customSortFolderDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.applyCustomSortFolder}},[e._v("应用排序")])],1)]),t("ImportExport",{attrs:{"import-dialog-visible":e.importDialogVisible,"export-dialog-visible":e.exportDialogVisible},on:{"update:importDialogVisible":function(t){e.importDialogVisible=t},"update:import-dialog-visible":function(t){e.importDialogVisible=t},"update:exportDialogVisible":function(t){e.exportDialogVisible=t},"update:export-dialog-visible":function(t){e.exportDialogVisible=t}}})],1)},n=[],l=(r(4114),r(8111),r(2489),r(116),r(7588),r(1701),r(7642),r(8004),r(3853),r(5876),r(2475),r(5024),r(1698),r(1910));const d={MAX_FILE_SIZE:10485760,SUPPORTED_FILE_EXTENSIONS:[".html",".htm"],DEBOUNCE_DELAY:{SEARCH:300,TREE_EXPAND:100,RESOURCE_CLEANUP:100},TEXT_LIMITS:{FOLDER_NAME:50,BOOKMARK_NAME:500,BOOKMARK_DESCRIPTION:500,FILE_NAME:255},MAX_DEPTH:{FOLDER_PARSING:20,HTML_GENERATION:20},PAGINATION:{ROOT_PAGE_SIZES:[50,100,200,500],FOLDER_PAGE_SIZES:[10,20,50,100],DEFAULT_SEARCH_RESULTS:50,ROOT_MAX_HEIGHT:600,FOLDER_MAX_HEIGHT:500},CACHE_LIMITS:{MAX_PATH_CACHE_SIZE:1e4,MAX_BOOKMARK_CACHE_SIZE:5e3,MAX_SEARCH_CACHE_SIZE:1e3},LAYOUT:{SIDEBAR_MIN_WIDTH:180,SIDEBAR_MAX_OFFSET:350,CHANGE_THRESHOLD:.8},TIME_CONVERSION:{MS_TO_SECONDS:1e3},SUPPORTED_PROTOCOLS:["http:","https:","ftp:"],CHAR_CODES:{MIN_PRINTABLE:32,DELETE:127}};r(4603),r(7566),r(8721);const c={log:(...e)=>{0},warn:(...e)=>{console.warn(...e)},error:(...e)=>{console.error(...e)},info:(...e)=>{0}};class m{static isEmpty(e){return null===e||void 0===e||""===e}static isBlankString(e){return"string"!==typeof e||""===e.trim()}static safeGet(e,t,r=null){if(!e||"object"!==typeof e)return r;const o=t.split(".");let a=e;for(const i of o){if(null===a||void 0===a||!(i in a))return r;a=a[i]}return a}static isValidUrl(e){if(this.isBlankString(e))return!1;try{const t=new URL(e);return["http:","https:","ftp:"].includes(t.protocol)}catch{return!1}}static isSafeFileName(e){if(this.isBlankString(e))return!1;const t=/[<>:"/\\|?*]/;if(t.test(e))return!1;for(let o=0;o<e.length;o++){const t=e.charCodeAt(o);if(t>=0&&t<=31)return!1}const r=["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"];return!r.includes(e.toUpperCase())&&e.length<=255}static isValidTextLength(e,t){return!!this.isEmpty(e)||"string"===typeof e&&e.length<=t}static isValidArray(e){return Array.isArray(e)&&e.length>0}static isValidId(e){return!this.isBlankString(e)&&(/^[a-zA-Z0-9_-]+$/.test(e)&&e.length<=50)}}class h{static validateBookmark(e){const t=[];return e&&"object"===typeof e?(m.isValidId(e.id)||t.push("书签ID格式无效"),m.isBlankString(e.name)?t.push("书签名称不能为空"):m.isValidTextLength(e.name,d.TEXT_LIMITS.BOOKMARK_NAME)||t.push(`书签名称长度不能超过${d.TEXT_LIMITS.BOOKMARK_NAME}个字符`),m.isValidUrl(e.url)||t.push("书签URL格式无效"),m.isEmpty(e.folderId)||m.isValidId(e.folderId)||t.push("文件夹ID格式无效"),{isValid:0===t.length,errors:t}):(t.push("书签必须是一个对象"),{isValid:!1,errors:t})}static validateFolder(e){const t=[];return e&&"object"===typeof e?(m.isValidId(e.id)||t.push("文件夹ID格式无效"),m.isBlankString(e.name)?t.push("文件夹名称不能为空"):m.isValidTextLength(e.name,d.TEXT_LIMITS.FOLDER_NAME)||t.push(`文件夹名称长度不能超过${d.TEXT_LIMITS.FOLDER_NAME}个字符`),m.isEmpty(e.parentId)||m.isValidId(e.parentId)||t.push("父文件夹ID格式无效"),{isValid:0===t.length,errors:t}):(t.push("文件夹必须是一个对象"),{isValid:!1,errors:t})}}class u{static escapeHtml(e){if(m.isEmpty(e))return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}static stripHtml(e){if(m.isEmpty(e))return"";const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}static sanitizeInput(e){return m.isEmpty(e)?"":String(e).replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/data:/gi,"").trim()}static sanitizeUrl(e){if(!m.isValidUrl(e))return"";try{const t=new URL(e);return["http:","https:","ftp:"].includes(t.protocol)?t.toString():""}catch{return""}}}class p{static safeExecute(e,t=null,r=null){try{return e()}catch(o){return r&&"function"===typeof r?r(o):c.error("执行出错:",o),t}}static async safeExecuteAsync(e,t=null,r=null){try{return await e()}catch(o){return r&&"function"===typeof r?r(o):c.error("异步执行出错:",o),t}}static formatError(e,t=""){if(!e)return"未知错误";const r=t?`[${t}] `:"";return e.message?`${r}${e.message}`:"string"===typeof e?`${r}${e}`:`${r}未知错误`}}var g=function(){var e=this,t=e._self._c;return t("div",{staticClass:"header"},[e._m(0),t("div",{staticClass:"search-box"},[t("el-input",{attrs:{placeholder:"搜索收藏夹","prefix-icon":"el-icon-search",clearable:"",maxlength:e.$store.state.constants?e.$store.state.constants.TEXT_LIMITS.BOOKMARK_NAME:100,"show-word-limit":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1)],1),t("div",{staticClass:"path-navigator"},[t("el-popover",{attrs:{placement:"bottom",width:"400",trigger:"click"},model:{value:e.showPathNavigator,callback:function(t){e.showPathNavigator=t},expression:"showPathNavigator"}},[t("div",{staticClass:"path-input-container"},[t("p",{staticClass:"path-tip"},[e._v("输入路径如 "),t("code",[e._v("收藏夹根目录/工作/项目")]),e._v(" 进行跳转")]),t("el-input",{attrs:{placeholder:"输入路径，使用 / 分隔层级",clearable:"",maxlength:e.$store.state.constants?e.$store.state.constants.TEXT_LIMITS.FILE_NAME:255,"show-word-limit":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.navigateByPath.apply(null,arguments)}},model:{value:e.pathInput,callback:function(t){e.pathInput=t},expression:"pathInput"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-position"},on:{click:e.navigateByPath},slot:"append"},[e._v("跳转")])],1),e.pathSuggestions.length>0?t("div",{staticClass:"path-suggestions"},[t("p",[e._v("可能的路径：")]),t("ul",{staticClass:"suggestion-list"},e._l(e.pathSuggestions,(function(r,o){return t("li",{key:o,staticClass:"suggestion-item",attrs:{title:r.pathString},on:{click:function(t){return e.selectSuggestion(r)}}},[e._v(" "+e._s(r.pathString)+" ")])})),0)]):e._e()],1),t("el-button",{attrs:{slot:"reference",icon:"el-icon-location"},slot:"reference"},[e._v("路径导航")])],1)],1),t("div",{staticClass:"actions"},[t("el-button-group",[t("el-button",{attrs:{disabled:!e.canUndo,icon:"el-icon-refresh-left",size:"small",title:"撤销"},on:{click:e.handleUndo}}),t("el-button",{attrs:{disabled:!e.canRedo,icon:"el-icon-refresh-right",size:"small",title:"重做"},on:{click:e.handleRedo}})],1),t("el-button-group",{staticStyle:{"margin-left":"10px"}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.showAddBookmarkDialog}},[e._v("添加收藏")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-folder-add"},on:{click:e.showAddFolderDialog}},[e._v("添加文件夹")]),t("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-more"}},[e._v(" 更多操作"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"importBookmarks"}},[t("i",{staticClass:"el-icon-download"}),e._v(" 导入书签 ")]),t("el-dropdown-item",{attrs:{command:"exportBookmarks"}},[t("i",{staticClass:"el-icon-upload2"}),e._v(" 导出书签 ")]),t("el-dropdown-item",{attrs:{divided:"",command:"checkInvalid"}},[t("i",{staticClass:"el-icon-warning-outline"}),e._v(" 检测失效书签 ")]),t("el-dropdown-item",{attrs:{command:"checkDuplicate"}},[t("i",{staticClass:"el-icon-copy-document"}),e._v(" 检测重复书签 ")]),t("el-dropdown-item",{attrs:{divided:"",command:"resetAll"}},[t("i",{staticClass:"el-icon-delete"}),e._v(" 清除所有收藏夹 ")])],1)],1)],1)],1)])},f=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"logo"},[t("h1",[e._v("收藏夹管理助手")])])}],k={name:"HeaderComponent",data(){return{searchQuery:"",showPathNavigator:!1,pathInput:"",pathSuggestions:[],pathSearchTimer:null}},props:{folders:{type:Array,default:()=>[]}},computed:{...(0,l.aH)("bookmarks",["history","currentHistoryIndex"]),canUndo(){return this.currentHistoryIndex>=0},canRedo(){return this.currentHistoryIndex<this.history.length-1},currentOperation(){return this.currentHistoryIndex>=0&&this.history[this.currentHistoryIndex]?u.escapeHtml(this.history[this.currentHistoryIndex].description||"操作"):""},nextOperation(){const e=this.currentHistoryIndex+1;return e<this.history.length&&this.history[e]?u.escapeHtml(this.history[e].description||"操作"):""},safeSearchQuery(){return u.escapeHtml(this.searchQuery)},safePathInput(){return u.escapeHtml(this.pathInput)}},methods:{...(0,l.i0)("bookmarks",["undo","redo"]),handleSearch(){return p.safeExecute((()=>{const e=this.validateAndSanitizeSearchQuery(this.searchQuery);null!==e&&this.$emit("search",e)}),"搜索操作失败")},validateAndSanitizeSearchQuery(e){return m.isEmpty(e)?"":e.length>d.TEXT_LIMITS.BOOKMARK_NAME?(this.$message.warning(`搜索内容不能超过${d.TEXT_LIMITS.BOOKMARK_NAME}个字符`),null):u.sanitizeInput(e)},showAddBookmarkDialog(){return p.safeExecute((()=>{this.$emit("add-bookmark")}),"打开添加书签对话框失败")},showAddFolderDialog(){return p.safeExecute((()=>{this.$emit("add-folder")}),"打开添加文件夹对话框失败")},handleCommand(e){return p.safeExecute((()=>{this.isValidCommand(e)?this.$emit(e):this.$message.error("无效的操作命令")}),"执行操作命令失败")},isValidCommand(e){const t=["importBookmarks","exportBookmarks","checkInvalid","checkDuplicate","resetAll"];return t.includes(e)},handleUndo(){return p.safeExecute((()=>{this.canUndo&&(this.undo(),this.$message({type:"success",message:`已撤销: ${this.currentOperation}`,duration:1500}))}),"撤销操作失败")},handleRedo(){return p.safeExecute((()=>{this.canRedo&&(this.redo(),this.$message({type:"success",message:`已重做: ${this.nextOperation}`,duration:1500}))}),"重做操作失败")},navigateByPath(){return p.safeExecute((()=>{const e=this.validateAndSanitizePathInput(this.pathInput);null!==e&&(m.isEmpty(e)?this.$message.warning("请输入有效的路径"):(this.$emit("navigate-by-path",e),this.pathInput="",this.showPathNavigator=!1))}),"路径导航失败")},validateAndSanitizePathInput(e){if(m.isEmpty(e))return"";if(e.length>d.TEXT_LIMITS.FILE_NAME)return this.$message.warning(`路径长度不能超过${d.TEXT_LIMITS.FILE_NAME}个字符`),null;const t=["<",">",'"',"'","&"];return t.some((t=>e.includes(t)))?(this.$message.warning("路径包含非法字符"),null):u.sanitizeInput(e.trim())},searchPaths(){return p.safeExecute((()=>{if(this.pathSearchTimer&&clearTimeout(this.pathSearchTimer),m.isEmpty(this.pathInput))return void(this.pathSuggestions=[]);const e=this.validateAndSanitizePathInput(this.pathInput);null!==e?this.pathSearchTimer=setTimeout((()=>{this.$emit("search-paths",e,(e=>{this.pathSuggestions=this.validatePathSuggestions(e)}))}),d.DEBOUNCE_DELAY.SEARCH):this.pathSuggestions=[]}),"搜索路径失败")},validatePathSuggestions(e){return m.isValidArray(e)?e.filter((e=>e&&m.isValidId(e.id)&&"string"===typeof e.pathString&&e.pathString.length<=d.TEXT_LIMITS.FILE_NAME)).map((e=>({id:e.id,pathString:u.escapeHtml(e.pathString)}))):[]},selectSuggestion(e){return p.safeExecute((()=>{e&&m.isValidId(e.id)?(this.$emit("navigate-to-folder",e.id),this.pathInput="",this.showPathNavigator=!1):this.$message.error("无效的路径建议")}),"选择路径建议失败")},safeCleanup(){this.pathSearchTimer&&(clearTimeout(this.pathSearchTimer),this.pathSearchTimer=null),this.pathSuggestions=[]}},watch:{pathInput(){this.searchPaths()},searchQuery(e){e&&e.length>d.TEXT_LIMITS.BOOKMARK_NAME&&this.$nextTick((()=>{this.searchQuery=e.substring(0,d.TEXT_LIMITS.BOOKMARK_NAME),this.$message.warning(`搜索内容已截断到${d.TEXT_LIMITS.BOOKMARK_NAME}个字符`)}))}},beforeDestroy(){this.safeCleanup()}},I=k,v=r(1656),E=(0,v.A)(I,g,f,!1,null,"2f6403bb",null),y=E.exports,b=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sidebar"},[e._m(0),t("div",{staticClass:"sidebar-content"},[t("el-tree",{key:e.treeKey,ref:"folderTree",attrs:{data:e.folderTreeData,props:e.defaultProps,"node-key":"id","default-expanded-keys":e.defaultExpandedKeys,"expand-on-click-node":!1,"highlight-current":!0,"allow-drop":e.allowDrop,"allow-drag":e.allowDrag,draggable:""},on:{"node-click":e.handleNodeClick,"node-expand":e.handleNodeExpand,"node-collapse":e.handleNodeCollapse,"node-drag-start":e.handleDragStart,"node-drag-enter":e.handleDragEnter,"node-drag-leave":e.handleDragLeave,"node-drag-over":e.handleDragOver,"node-drag-end":e.handleDragEnd,"node-drop":e.handleDrop},scopedSlots:e._u([{key:"default",fn:function({node:r,data:o}){return t("span",{staticClass:"custom-tree-node",on:{dragover:function(t){return e.handleFolderDragOver(t)},dragenter:function(t){return e.handleFolderDragEnter(t)},dragleave:function(t){return e.handleFolderDragLeave(t)},drop:function(t){return e.handleFolderDrop(t,o)}}},[t("span",[t("i",{class:["folder-icon",o.isExpanded?"el-icon-folder-opened":"el-icon-folder"]}),t("span",{domProps:{innerHTML:e._s(r.label)}})]),t("span",{staticClass:"actions"},[t("el-dropdown",{attrs:{trigger:"click"},on:{command:t=>e.handleCommand(t,o),click:function(e){e.stopPropagation()}}},[t("i",{staticClass:"el-icon-more"}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"rename"}},[e._v("重命名")]),t("el-dropdown-item",{attrs:{command:"addBookmark"}},[e._v("添加书签")]),t("el-dropdown-item",{attrs:{command:"addFolder"}},[e._v("添加子文件夹")]),t("el-dropdown-item",{attrs:{divided:"",command:"sortByName"}},[e._v("按名称排序")]),t("el-dropdown-item",{attrs:{command:"customSort"}},[e._v("自定义排序")]),"root"!==o.id?t("el-dropdown-item",{attrs:{divided:"",command:"delete"}},[e._v("删除")]):e._e()],1)],1)],1)])}}])})],1),t("div",{staticClass:"sidebar-footer"},[t("div",{staticClass:"special-folders"},[t("div",{staticClass:"special-folder",on:{click:e.showInvalidBookmarks}},[t("i",{staticClass:"el-icon-warning-outline"}),t("span",[e._v("失效书签")])]),t("div",{staticClass:"special-folder",on:{click:e.showDuplicateBookmarks}},[t("i",{staticClass:"el-icon-copy-document"}),t("span",[e._v("重复书签")])])])])])},S=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"sidebar-header"},[t("h2",[e._v("收藏夹")])])}],T={name:"SidebarComponent",data(){return{defaultProps:{children:"children",label:"name"},draggingNode:null,dropNode:null,treeKey:0,expandTimer:null}},watch:{folders:{handler(e,t){return p.safeExecute((()=>{m.isValidArray(e)?t&&1===e.length&&t.length>5&&this.$nextTick((()=>{this.$refs.folderTree&&(this.$refs.folderTree.setCurrentKey("root"),this.needsCompleteRefresh(e,t)&&(this.treeKey+=1))})):c.warn("接收到无效的文件夹数据")}),"文件夹状态更新失败")},deep:!0},defaultExpandedKeys(e,t){return p.safeExecute((()=>{m.isValidArray(e)&&m.isValidArray(t)&&(this.expandTimer&&clearTimeout(this.expandTimer),this.expandTimer=setTimeout((()=>{this.$nextTick((()=>{if(this.$refs.folderTree){const r=e.filter((e=>!t.includes(e))),o=t.filter((t=>!e.includes(t)));r.forEach((e=>{m.isValidId(e)&&this.$refs.folderTree.setExpanded(e,!0)})),o.forEach((e=>{m.isValidId(e)&&this.$refs.folderTree.setExpanded(e,!1)}))}}))}),d.DEBOUNCE_DELAY.TREE_EXPAND))}),"展开状态同步失败")}},computed:{...(0,l.aH)({folders:e=>e.bookmarks.folders}),...(0,l.L8)("bookmarks",["getFoldersByParentId","getAllChildFolders"]),folderTreeData(){return p.safeExecute((()=>{if(!m.isValidArray(this.folders))return[];const e=t=>{if(!m.isValidId(t))return[];const r=this.getFoldersByParentId(t);return m.isValidArray(r)?r.map((t=>{if(!this.isValidFolderData(t))return null;const r=e(t.id);return{...t,name:u.escapeHtml(t.name||"未命名文件夹"),children:r}})).filter(Boolean):[]},t=this.folders.find((e=>"root"===e.id));return t&&this.isValidFolderData(t)?[{...t,name:u.escapeHtml(t.name||"收藏夹根目录"),children:e("root")}]:[]}),"构建文件夹树失败",[])},defaultExpandedKeys(){return p.safeExecute((()=>{const e=[];return e.push("root"),m.isValidArray(this.folders)&&this.folders.forEach((t=>{this.isValidFolderData(t)&&t.isExpanded&&"root"!==t.id&&e.push(t.id)})),e}),"计算展开节点失败",["root"])}},methods:{...(0,l.i0)("bookmarks",["sortFoldersByName","deleteFolder","addFolder","updateFolder","moveItems"]),isValidFolderData(e){return e&&"object"===typeof e&&m.isValidId(e.id)&&"string"===typeof e.name&&e.name.length<=d.TEXT_LIMITS.FOLDER_NAME},validateAndSanitizeFolderName(e){return m.isEmpty(e)?(this.$message.warning("文件夹名称不能为空"),null):e.length>d.TEXT_LIMITS.FOLDER_NAME?(this.$message.warning(`文件夹名称不能超过${d.TEXT_LIMITS.FOLDER_NAME}个字符`),null):u.sanitizeInput(e.trim())},handleNodeClick(e){return p.safeExecute((()=>{this.isValidFolderData(e)?this.$emit("folder-selected",e.id):this.$message.error("无效的文件夹数据")}),"文件夹选择失败")},handleNodeExpand(e){return p.safeExecute((()=>{this.isValidFolderData(e)&&"root"!==e.id&&this.updateFolder({id:e.id,updates:{isExpanded:!0}})}),"文件夹展开失败")},handleNodeCollapse(e){return p.safeExecute((()=>{this.isValidFolderData(e)&&"root"!==e.id&&this.updateFolder({id:e.id,updates:{isExpanded:!1}})}),"文件夹折叠失败")},handleCommand(e,t){return p.safeExecute((()=>{if(this.isValidCommand(e)&&this.isValidFolderData(t))switch(e){case"rename":this.$prompt("请输入新文件夹名称","重命名",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.name,inputValidator:e=>{const t=this.validateAndSanitizeFolderName(e);return null!==t},inputErrorMessage:"请输入有效的文件夹名称"}).then((({value:e})=>{const r=this.validateAndSanitizeFolderName(e);r&&this.updateFolder({id:t.id,updates:{name:r}})})).catch((()=>{}));break;case"addBookmark":this.$emit("add-bookmark",t.id);break;case"addFolder":this.$prompt("请输入文件夹名称","新建文件夹",{confirmButtonText:"确定",cancelButtonText:"取消",inputValidator:e=>{const t=this.validateAndSanitizeFolderName(e);return null!==t},inputErrorMessage:"请输入有效的文件夹名称"}).then((({value:e})=>{const r=this.validateAndSanitizeFolderName(e);r&&this.addFolder({name:r,parentId:t.id})})).catch((()=>{}));break;case"sortByName":this.sortFoldersByName(t.id);break;case"customSort":this.$emit("custom-sort-folder",t.id);break;case"delete":if("root"===t.id)return void this.$message.warning("不能删除根文件夹");this.$confirm("此操作将永久删除该文件夹及其所有内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.deleteFolder(t.id),this.$emit("folder-selected","root")})).catch((()=>{}));break}else this.$message.error("无效的操作命令或文件夹数据")}),"文件夹操作失败")},isValidCommand(e){const t=["rename","addBookmark","addFolder","sortByName","customSort","delete"];return t.includes(e)},showInvalidBookmarks(){return p.safeExecute((()=>{this.$emit("show-special-folder","invalid")}),"显示失效书签失败")},showDuplicateBookmarks(){return p.safeExecute((()=>{this.$emit("show-special-folder","duplicate")}),"显示重复书签失败")},allowDrop(e,t){return p.safeExecute((()=>{if(!e||!t||!this.isValidFolderData(e.data)||!this.isValidFolderData(t.data))return!1;if(e.data.id===t.data.id)return!1;let r=t.parent;while(r){if(r.data&&r.data.id===e.data.id)return!1;r=r.parent}return!0}),"拖拽验证失败",!1)},allowDrag(e){return p.safeExecute((()=>!(!e||!this.isValidFolderData(e.data))&&"root"!==e.data.id),"拖拽检查失败",!1)},handleDragStart(e){return p.safeExecute((()=>{e&&this.isValidFolderData(e.data)&&(this.draggingNode=e)}),"开始拖拽失败")},handleDragEnter(){},handleDragLeave(e){return p.safeExecute((()=>{e&&e.currentTarget&&e.currentTarget.classList.remove("dragover"),document.querySelectorAll(".dragover").forEach((e=>{e.classList.remove("dragover")}))}),"拖拽离开处理失败")},handleDragOver(){},handleDragEnd(){return p.safeExecute((()=>{this.draggingNode=null,this.dropNode=null,document.querySelectorAll(".dragover").forEach((e=>{e.classList.remove("dragover")}))}),"拖拽结束处理失败")},handleDrop(e,t,r){return p.safeExecute((()=>{if(e&&t&&this.isValidFolderData(e.data)&&this.isValidFolderData(t.data))if("inner"===r)this.moveItems({itemIds:[e.data.id],targetFolderId:t.data.id,itemType:"folder"});else{const r=t.data.parentId;m.isValidId(r)&&this.moveItems({itemIds:[e.data.id],targetFolderId:r,itemType:"folder"})}else this.$message.error("拖拽数据无效")}),"文件夹拖拽失败")},handleFolderDragEnter(e){return p.safeExecute((()=>{document.querySelectorAll(".dragover").forEach((e=>{e.classList.remove("dragover")}))}),"拖拽进入处理失败")},handleFolderDragLeave(e){return p.safeExecute((()=>{if(!e||!e.currentTarget)return;const t=e.currentTarget.getBoundingClientRect(),r=e.clientX,o=e.clientY;(r<t.left||r>t.right||o<t.top||o>t.bottom)&&e.currentTarget.classList.remove("dragover")}),"拖拽离开处理失败")},handleFolderDragOver(e){return p.safeExecute((()=>{e&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move"),document.querySelectorAll(".dragover").forEach((t=>{t!==e.currentTarget&&t.classList.remove("dragover")})),e.currentTarget&&e.currentTarget.classList.add("dragover"))}),"拖拽悬停处理失败")},handleFolderDrop(e,t){return p.safeExecute((()=>{if(e&&this.isValidFolderData(t)&&(e.preventDefault(),document.querySelectorAll(".dragover").forEach((e=>{e.classList.remove("dragover")})),e.dataTransfer))try{const r=e.dataTransfer.getData("application/json");if(!r)return;const o=JSON.parse(r);if(!o||"object"!==typeof o)return;if("bookmark"===o.type&&m.isValidId(o.id)){this.moveItems({itemIds:[o.id],targetFolderId:t.id,itemType:"bookmark"});const e=u.escapeHtml(o.name||"未命名书签"),r=u.escapeHtml(t.name||"未命名文件夹");this.$message({type:"success",message:`已将书签"${e}"移动到"${r}"文件夹`})}}catch(r){c.error("拖放数据处理错误:",r),this.$message.error("拖放操作失败")}}),"文件夹拖放处理失败")},needsCompleteRefresh(e,t){return p.safeExecute((()=>{if(!m.isValidArray(e)||!m.isValidArray(t))return!1;const r=Math.abs(e.length-t.length),o=t.length>0?r/t.length:0;return o>d.LAYOUT.CHANGE_THRESHOLD}),"刷新检查失败",!1)},safeCleanup(){this.expandTimer&&(clearTimeout(this.expandTimer),this.expandTimer=null),this.draggingNode=null,this.dropNode=null}},beforeDestroy(){this.safeCleanup()}},D=T,w=(0,v.A)(D,b,S,!1,null,"c296ef0e",null),_=w.exports,x=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bookmark-list"},[t("div",{staticClass:"list-header"},[t("div",{staticClass:"path-navigation"},[t("el-breadcrumb",{attrs:{separator:"/"}},e._l(e.folderPath,(function(r){return t("el-breadcrumb-item",{key:r.id,nativeOn:{click:function(t){return e.navigateToFolder(r.id)}}},[e._v(" "+e._s(e.safeDisplayText(r.name))+" ")])})),1),t("el-tooltip",{attrs:{content:"复制当前路径",placement:"top"}},[t("i",{staticClass:"el-icon-copy-document copy-path-icon",on:{click:e.copyCurrentPath}})]),"root"===e.currentFolderId?t("div",{staticClass:"root-tip"},[t("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("显示所有书签")])],1):e._e()],1),t("div",{staticClass:"list-actions"},[e.selectedBookmarks.length>0?t("el-button-group",[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.moveBulk}},[e._v("移动")]),t("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.deleteBulk}},[e._v("删除")])],1):e._e(),e.bookmarks.length>0&&"root"!==e.currentFolderId?t("el-dropdown",{on:{command:e.handleSortCommand}},[t("el-button",{attrs:{size:"small"}},[e._v(" 排序"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"name"}},[e._v("按名称排序")]),t("el-dropdown-item",{attrs:{command:"url"}},[e._v("按URL排序")]),t("el-dropdown-item",{attrs:{command:"date"}},[e._v("按添加日期排序")]),t("el-dropdown-item",{attrs:{command:"custom"}},[e._v("自定义排序")])],1)],1):e._e(),"root"===e.currentFolderId?t("el-tooltip",{attrs:{content:"根目录显示所有书签，无法排序。请进入具体文件夹进行排序。",placement:"top"}},[t("el-button",{attrs:{size:"small",disabled:""}},[e._v(" 排序"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1):e._e()],1)]),t("div",{staticClass:"bookmark-table-wrapper"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"bookmarkTable",class:{"dragging-active":e.dragState.isDragging},staticStyle:{width:"100%"},attrs:{data:e.paginatedBookmarks,"row-key":"id",height:"100%","max-height":"root"===e.currentFolderId?600:500,lazy:""},on:{"selection-change":e.handleSelectionChange,"row-contextmenu":e.handleContextMenu,"row-click":e.handleRowClick}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{label:"名称","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("div",{staticClass:"bookmark-name",class:{dragging:e.dragState.isDragging&&r.row.id===e.dragState.draggedBookmark?.id,"drop-target":e.dragState.isDragging&&r.$index===e.dragState.dropTargetIndex,"drag-above":e.dragState.isDragging&&r.$index===e.dragState.dropTargetIndex&&"above"===e.dragState.dropPosition,"drag-below":e.dragState.isDragging&&r.$index===e.dragState.dropTargetIndex&&"below"===e.dragState.dropPosition},attrs:{draggable:"true"},on:{dragstart:function(t){return e.handleDragStart(t,r.row,r.$index)},dragover:function(t){return e.handleDragOver(t,r.$index)},dragenter:function(t){return e.handleDragEnter(t,r.$index)},dragleave:function(t){return e.handleDragLeave(t)},drop:function(t){return e.handleDrop(t,r.$index)},dragend:function(t){return e.handleDragEnd(t)}}},[t("img",{ref:"favicon",staticClass:"favicon",attrs:{"data-url":r.row.url,"data-bookmark-id":r.row.id,alt:"",src:e.getInitialFaviconSrc(r.row.url)},on:{error:e.handleFaviconError,load:e.handleFaviconLoad}}),t("span",[e._v(e._s(r.row.name))]),e.specialMode||"root"===e.currentFolderId?e._e():t("i",{staticClass:"el-icon-sort drag-handle",attrs:{title:"拖拽排序"}})])]}}])}),t("el-table-column",{attrs:{prop:"url",label:"URL","min-width":"250"}}),t("el-table-column",{attrs:{label:"所在路径","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("div",{staticClass:"bookmark-path"},[t("span",[e._v(e._s(e.getBookmarkPath(r.row)))]),t("i",{staticClass:"el-icon-copy-document copy-item-path",attrs:{title:"复制路径"},on:{click:function(t){return e.copyItemPath(r.row)}}})])]}}])}),t("el-table-column",{attrs:{label:"添加日期",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.createdAt))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.openBookmark(r.row)}}},[e._v(" 打开 ")]),t("el-dropdown",{attrs:{trigger:"click"},on:{command:t=>e.handleCommand(t,r.row)}},[t("el-button",{attrs:{size:"mini",type:"text"}},[t("i",{staticClass:"el-icon-more"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"edit"}},[e._v("编辑")]),t("el-dropdown-item",{attrs:{command:"move"}},[e._v("移动")]),t("el-dropdown-item",{attrs:{command:"moveUp"}},[e._v("上移")]),t("el-dropdown-item",{attrs:{command:"moveDown"}},[e._v("下移")]),t("el-dropdown-item",{attrs:{command:"delete",divided:""}},[e._v("删除")])],1)],1)]}}])})],1)],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":"root"===e.currentFolderId?[50,100,200,500]:[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.bookmarks.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"编辑书签",visible:e.editDialogVisible,width:"500px"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.handleEditCancel}},[t("el-form",{attrs:{model:e.editForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"名称"}},[t("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),t("el-form-item",{attrs:{label:"URL"}},[t("el-input",{model:{value:e.editForm.url,callback:function(t){e.$set(e.editForm,"url",t)},expression:"editForm.url"}})],1),t("el-form-item",{attrs:{label:"描述"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.editForm.description,callback:function(t){e.$set(e.editForm,"description",t)},expression:"editForm.description"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleEditCancel}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveBookmark}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"移动到文件夹",visible:e.moveDialogVisible,width:"400px"},on:{"update:visible":function(t){e.moveDialogVisible=t}}},[t("el-tree",{attrs:{data:e.folderTreeData,props:e.defaultProps,"node-key":"id","default-expanded-keys":["root"],"highlight-current":!0},on:{"node-click":e.handleFolderSelect},scopedSlots:e._u([{key:"default",fn:function({node:r,data:o}){return t("span",{staticClass:"custom-tree-node"},[t("i",{class:["folder-icon",o.isExpanded?"el-icon-folder-opened":"el-icon-folder"]}),e._v(" "+e._s(r.label)+" ")])}}])}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.moveDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",disabled:!e.selectedFolderId},on:{click:e.moveBookmark}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"自定义排序",visible:e.customSortDialogVisible,width:"600px"},on:{"update:visible":function(t){e.customSortDialogVisible=t}}},[t("div",{staticClass:"custom-sort-content"},[t("p",[e._v("请输入自定义排序函数（JavaScript）：")]),t("p",{staticClass:"sort-instruction"},[t("small",[e._v("• 支持函数体格式："),t("code",[e._v("return a.name.localeCompare(b.name)")])]),t("br"),t("small",[e._v("• 支持箭头函数格式："),t("code",[e._v("(a, b) => a.name.localeCompare(b.name)")])]),t("br"),t("small",[e._v("• 参数a、b代表要比较的两个书签对象")])]),t("el-input",{attrs:{type:"textarea",rows:8,placeholder:"例如：return a.name.localeCompare(b.name)"},model:{value:e.customSortFunction,callback:function(t){e.customSortFunction=t},expression:"customSortFunction"}}),t("div",{staticClass:"example-section"},[t("p",[e._v("示例：")]),t("pre",[e._v("// 按名称的字符长度排序\nreturn a.name.length - b.name.length;\n\n// 按名称的拼音首字母排序\nreturn a.name.localeCompare(b.name, 'zh-CN');\n\n// 按创建时间排序\nreturn new Date(a.createdAt) - new Date(b.createdAt);\n\n// 综合多个条件排序\nif (a.url && b.url) {\n  const domainA = new URL(a.url).hostname;\n  const domainB = new URL(b.url).hostname;\n  const domainCompare = domainA.localeCompare(domainB);\n  \n  if (domainCompare === 0) {\n    return a.name.localeCompare(b.name);\n  }\n  \n  return domainCompare;\n} else {\n  return a.name.localeCompare(b.name);\n}")])])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.customSortDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.applyCustomSort}},[e._v("应用排序")])],1)])],1)},F=[],A={name:"BookmarkList",props:{currentFolderId:{type:String,required:!0},specialMode:{type:String,default:null}},data(){return{selectedBookmarks:[],currentPage:1,pageSize:50,loading:!1,editDialogVisible:!1,moveDialogVisible:!1,customSortDialogVisible:!1,editForm:{id:null,name:"",url:"",description:""},currentEditingBookmarkId:null,selectedFolderId:null,customSortFunction:"return a.name.localeCompare(b.name)",defaultProps:{children:"children",label:"name"},dragState:{isDragging:!1,draggedBookmark:null,draggedIndex:-1,dropTargetIndex:-1,originalIndex:-1,targetIndex:-1,dropPosition:null,dragPreviewElement:null,dragStartPosition:{x:0,y:0},isInternalDrag:!1,cancelKeys:["Escape","Enter"," "]},dragListeners:{keydown:null,click:null,mousemove:null,dragend:null},lazyLoading:{observer:null,loadedIcons:new Set,failedIcons:new Set,retryCount:new Map,loadingIcons:new Set,maxRetries:2,retryDelay:1e3,defaultIcon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iOCIgY3k9IjgiIHI9IjYiIGZpbGw9IiNmNWY1ZjUiIHN0cm9rZT0iI2RkZCIgc3Ryb2tlLXdpZHRoPSIwLjUiLz4KPGNpcmNsZSBjeD0iOCIgY3k9IjgiIHI9IjIiIGZpbGw9IiM5OTkiLz4KPHN2Zz4="}}},computed:{...(0,l.aH)({folders:e=>e.bookmarks.folders,invalidBookmarks:e=>e.bookmarks.invalidBookmarks,duplicateBookmarks:e=>e.bookmarks.duplicateBookmarks}),...(0,l.L8)("bookmarks",["getBookmarksByFolderId","getAllBookmarks","getAllBookmarksWithPath","getFoldersByParentId","getFolderPath"]),bookmarks(){return"invalid"===this.specialMode?this.invalidBookmarks:"duplicate"===this.specialMode?this.duplicateBookmarks:"root"===this.currentFolderId?this.getAllBookmarksWithPath:this.getBookmarksByFolderId(this.currentFolderId)},paginatedBookmarks(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.bookmarks.slice(e,t)},folderPath(){if(this.specialMode){const e=this.folders.find((e=>"root"===e.id)),t={id:this.specialMode,name:"invalid"===this.specialMode?"失效书签":"重复书签"};return[e,t]}return this.getFolderPath(this.currentFolderId)},folderTreeData(){const e=t=>{const r=this.getFoldersByParentId(t);return r.map((t=>{const r=e(t.id);return{...t,children:r.length?r:[]}}))},t=this.folders.find((e=>"root"===e.id));return t?[{...t,children:e("root")}]:[]}},watch:{currentFolderId(e,t){this.currentPage=1,this.selectedBookmarks=[],"root"===e&&"root"!==t?this.pageSize=100:"root"!==e&&"root"===t&&(this.pageSize=20),this.$nextTick((()=>{this.observeFaviconElements()}))},specialMode(){this.currentPage=1,this.selectedBookmarks=[],this.$nextTick((()=>{this.observeFaviconElements()}))},currentPage(){this.$nextTick((()=>{this.observeFaviconElements()}))},pageSize(){this.$nextTick((()=>{this.observeFaviconElements()}))},"bookmarks.length"(){const e=Math.ceil(this.bookmarks.length/this.pageSize)||1;this.currentPage>e&&(this.currentPage=e),this.$nextTick((()=>{this.observeFaviconElements()}))},editDialogVisible(e){if(e&&this.currentEditingBookmarkId){const e=this.getAllBookmarks.find((e=>e.id===this.currentEditingBookmarkId));e&&(this.editForm={...e})}else e||(this.currentEditingBookmarkId=null)}},methods:{...(0,l.i0)("bookmarks",["updateBookmark","deleteBookmark","deleteBookmarksBulk","moveItems","sortBookmarksByName","sortBookmarksByUrl","sortBookmarksByDate","sortBookmarksCustom","checkInvalidBookmarks","checkDuplicateBookmarks","moveBookmarkUp","moveBookmarkDown"]),safeDisplayText(e){return m.isEmpty(e)?"":u.stripHtml(String(e))},validateAndSanitizeInput(e,t=null){if(m.isEmpty(e))return"";let r=u.sanitizeInput(e);return t&&r.length>t&&(r=r.substring(0,t)),r},handleSelectionChange(e){this.selectedBookmarks=e},handleSizeChange(e){this.pageSize=e,this.currentPage=1},handleCurrentChange(e){this.currentPage=e},formatDate(e){if(this._dateCache||(this._dateCache=new Map),this._dateCache.has(e))return this._dateCache.get(e);const t=new Date(e),r=t.toLocaleString();return this._dateCache.set(e,r),r},getInitialFaviconSrc(e){return this.lazyLoading.loadedIcons.has(e)?this.getFavicon(e):(this.lazyLoading.failedIcons.has(e),this.lazyLoading.defaultIcon)},getFavicon(e){if(this._faviconCache||(this._faviconCache=new Map),this._faviconCache.has(e))return this._faviconCache.get(e);if(!m.isValidUrl(e))return this._faviconCache.set(e,""),"";try{const t=new URL(e),r=`${t.protocol}//${t.hostname}/favicon.ico`;return this._faviconCache.set(e,r),r}catch(t){return c.warn("生成favicon URL失败:",t),this._faviconCache.set(e,""),""}},handleFaviconError(e){const t=e.target.dataset.url;e.target.dataset.bookmarkId;if(t){this.lazyLoading.failedIcons.add(t),this.lazyLoading.loadingIcons.delete(t);const r=this.lazyLoading.retryCount.get(t)||0;r<this.lazyLoading.maxRetries?(setTimeout((()=>{this.retryFaviconLoad(e.target,t)}),this.lazyLoading.retryDelay*(r+1)),this.lazyLoading.retryCount.set(t,r+1),c.log(`Favicon加载失败，将在 ${this.lazyLoading.retryDelay*(r+1)}ms 后重试 (${r+1}/${this.lazyLoading.maxRetries})`,t)):(e.target.src=this.lazyLoading.defaultIcon,e.target.style.display="",c.warn("Favicon加载失败，已达最大重试次数:",t))}else e.target.style.display="none"},handleFaviconLoad(e){const t=e.target.dataset.url;t&&(this.lazyLoading.loadedIcons.add(t),this.lazyLoading.loadingIcons.delete(t),this.lazyLoading.failedIcons.delete(t),this.lazyLoading.retryCount.delete(t),this._faviconCache.set(t,e.target.src),c.log("Favicon加载成功:",t))},retryFaviconLoad(e,t){if(!e||!t)return;this.lazyLoading.failedIcons.delete(t),this.lazyLoading.loadingIcons.add(t);const r=this.getFavicon(t);r&&r!==this.lazyLoading.defaultIcon&&(e.src=r)},setupLazyLoading(){if(!("IntersectionObserver"in window))return c.warn("浏览器不支持Intersection Observer，将立即加载所有图标"),void this.loadAllFavicons();this.lazyLoading.observer=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){const t=e.target,r=t.dataset.url;!r||this.lazyLoading.loadingIcons.has(r)||this.lazyLoading.loadedIcons.has(r)||this.loadFaviconLazy(t,r),this.lazyLoading.observer.unobserve(t)}}))}),{root:null,rootMargin:"50px 0px",threshold:.1}),this.$nextTick((()=>{this.observeFaviconElements()}))},observeFaviconElements(){if(!this.lazyLoading.observer)return;const e=this.$el.querySelectorAll(".favicon[data-url]");e.forEach((e=>{const t=e.dataset.url;!t||this.lazyLoading.loadedIcons.has(t)||this.lazyLoading.failedIcons.has(t)||this.lazyLoading.observer.observe(e)}))},loadFaviconLazy(e,t){if(!e||!t)return;if(this.lazyLoading.loadingIcons.has(t)||this.lazyLoading.loadedIcons.has(t))return;this.lazyLoading.loadingIcons.add(t);const r=this.getFavicon(t);if(r&&r!==this.lazyLoading.defaultIcon){const o=new Image;o.onload=()=>{e.src=r,this.lazyLoading.loadedIcons.add(t),this.lazyLoading.loadingIcons.delete(t),this.lazyLoading.failedIcons.delete(t),this._faviconCache.set(t,r),c.log("懒加载favicon成功:",t)},o.onerror=()=>{this.lazyLoading.loadingIcons.delete(t),this.lazyLoading.failedIcons.add(t);const r=this.lazyLoading.retryCount.get(t)||0;r<this.lazyLoading.maxRetries?(setTimeout((()=>{this.retryFaviconLoad(e,t)}),this.lazyLoading.retryDelay*(r+1)),this.lazyLoading.retryCount.set(t,r+1),c.log(`懒加载favicon失败，将重试 (${r+1}/${this.lazyLoading.maxRetries})`,t)):c.warn("懒加载favicon失败，已达最大重试次数:",t)},o.src=r}},loadAllFavicons(){this.$nextTick((()=>{const e=this.$el.querySelectorAll(".favicon[data-url]");e.forEach((e=>{const t=e.dataset.url;t&&this.loadFaviconLazy(e,t)}))}))},cleanupLazyLoading(){this.lazyLoading.observer&&(this.lazyLoading.observer.disconnect(),this.lazyLoading.observer=null),this.lazyLoading.loadedIcons.clear(),this.lazyLoading.failedIcons.clear(),this.lazyLoading.retryCount.clear(),this.lazyLoading.loadingIcons.clear()},openBookmark(e){if(!e||!e.url)return void this.$message.error("书签信息无效");const t=u.sanitizeUrl(e.url);if(t)try{window.open(t,"_blank","noopener,noreferrer")}catch(r){c.error("打开书签失败:",r),this.$message.error("无法打开书签")}else this.$message.error("书签URL无效或不安全")},handleCommand(e,t){switch(e){case"edit":this.currentEditingBookmarkId=t.id,this.editForm={...t},this.editDialogVisible=!0;break;case"move":this.editForm={...t},this.moveDialogVisible=!0;break;case"moveUp":this.moveBookmarkUp(t.id);break;case"moveDown":this.moveBookmarkDown(t.id);break;case"delete":this.$confirm("此操作将永久删除该书签, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.deleteBookmark(t.id),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{}));break}},saveBookmark(){const e={name:this.validateAndSanitizeInput(this.editForm.name,d.TEXT_LIMITS.BOOKMARK_NAME),url:u.sanitizeUrl(this.editForm.url),description:this.validateAndSanitizeInput(this.editForm.description,500)};m.isBlankString(e.name)?this.$message.error("书签名称不能为空"):m.isValidUrl(e.url)?p.safeExecuteAsync((async()=>{await this.updateBookmark({id:this.editForm.id,updates:e}),this.editDialogVisible=!1,this.$message({type:"success",message:"更新成功!"})}),null,(e=>{c.error("保存书签失败:",e),this.$message.error(`保存失败: ${p.formatError(e)}`)})):this.$message.error("请输入有效的URL地址")},handleEditCancel(){this.editDialogVisible=!1},handleFolderSelect(e){this.selectedFolderId=e.id},moveBookmark(){this.selectedFolderId&&(this.moveItems({itemIds:[this.editForm.id],targetFolderId:this.selectedFolderId,itemType:"bookmark"}),this.moveDialogVisible=!1,this.$message({type:"success",message:"移动成功!"}))},moveBulk(){0!==this.selectedBookmarks.length&&(this.moveDialogVisible=!0,this.editForm={id:this.selectedBookmarks.map((e=>e.id))})},deleteBulk(){0!==this.selectedBookmarks.length&&this.$confirm(`此操作将永久删除选中的 ${this.selectedBookmarks.length} 个书签, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.deleteBookmarksBulk(this.selectedBookmarks.map((e=>e.id))),this.$message({type:"success",message:"批量删除成功!"})})).catch((()=>{}))},handleSortCommand(e){if("root"!==this.currentFolderId)switch(e){case"name":this.sortBookmarksByName(this.currentFolderId);break;case"url":this.sortBookmarksByUrl(this.currentFolderId);break;case"date":this.sortBookmarksByDate(this.currentFolderId);break;case"custom":this.customSortDialogVisible=!0;break}else this.$message({type:"warning",message:"根目录显示所有书签，无法排序。请进入具体文件夹进行排序。"})},validateAndSanitizeCustomSort(e){if(m.isEmpty(e))throw new Error("排序函数不能为空");let t=e.trim();const r=/^\s*\(\s*\w+\s*,\s*\w+\s*\)\s*=>\s*(.+)$/,o=t.match(r);if(o){const e=o[1].trim();t=e.startsWith("return ")||e.includes("return ")?e:`return ${e}`}t.startsWith("return ")||t.includes("return ")||(t=`return ${t}`);const a=["eval","Function","setTimeout","setInterval","document","window","global","process","require","import","fetch","XMLHttpRequest"];if(a.some((e=>t.includes(e))))throw new Error("排序函数包含不安全的内容");if(t.length>1e3)throw new Error("排序函数过长");try{new Function("a","b",t)}catch(i){throw new Error(`排序函数语法错误: ${i.message}`)}return u.sanitizeInput(t)},applyCustomSort(){try{if("root"===this.currentFolderId)return void this.$message({type:"warning",message:"根目录显示所有书签，无法排序。请进入具体文件夹进行排序。"});const e=this.validateAndSanitizeCustomSort(this.customSortFunction);this.sortBookmarksCustom({folderId:this.currentFolderId,sortFunctionString:e}),this.customSortDialogVisible=!1,this.$message({type:"success",message:"排序成功!"})}catch(e){this.$message({type:"error",message:e.message||"排序函数格式错误"})}},navigateToFolder(e){this.$emit("folder-selected",e)},handleContextMenu(e){e.preventDefault()},handleRowClick(){},handleDragStart(e,t,r){c.log("开始拖拽:",t.name,"at index:",r),this.resetDragState(),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/json",JSON.stringify({type:"bookmark",id:t.id,name:t.name}));const o="root"!==this.currentFolderId&&!this.specialMode;o?(this.dragState.isDragging=!0,this.dragState.isInternalDrag=!0,this.dragState.draggedBookmark=t,this.dragState.draggedIndex=r,this.dragState.originalIndex=r,this.dragState.dropTargetIndex=-1,this.dragState.dragStartPosition={x:e.clientX,y:e.clientY},this.createDragPreview(t,e),e.dataTransfer.setData("bookmark-reorder",JSON.stringify({type:"bookmark-reorder",id:t.id,originalIndex:r})),this.setupDragListeners(),this.clearSelection(),c.log("内部排序拖拽已启用")):c.log("使用跨文件夹拖拽模式"),this.setupDragEndHandler()},handleDragOver(e,t){if(!this.dragState.isDragging||!this.dragState.isInternalDrag)return;e.preventDefault(),e.dataTransfer.dropEffect="move";const r=e.currentTarget.getBoundingClientRect(),o=r.top+r.height/2;this.dragState.dropPosition=e.clientY<o?"above":"below";let a=t;"below"===this.dragState.dropPosition&&(a=t+1),this.dragState.draggedIndex<a&&(a-=1),this.dragState.dropTargetIndex=t,this.dragState.targetIndex=a},handleDragEnter(e,t){this.dragState.isDragging&&this.dragState.isInternalDrag&&e.preventDefault()},handleDragLeave(e){if(!this.dragState.isDragging||!this.dragState.isInternalDrag)return;const t=e.currentTarget.getBoundingClientRect(),r=e.clientX,o=e.clientY;(r<t.left||r>t.right||o<t.top||o>t.bottom)&&(this.dragState.dropTargetIndex=-1)},handleDrop(e,t){if(this.dragState.isDragging&&this.dragState.isInternalDrag){if(e.preventDefault(),c.log("放置操作，目标索引:",this.dragState.targetIndex,"原始索引:",this.dragState.originalIndex),this.dragState.targetIndex===this.dragState.originalIndex)return c.log("拖拽回原位置，取消操作"),void this.cancelDrag();this.performReorder()}},handleDragEnd(e){c.log("拖拽结束"),setTimeout((()=>{this.cleanupDrag()}),100)},createDragPreview(e,t){const r=document.createElement("div");r.className="drag-preview";const o=this.getFavicon(e.url);r.innerHTML=`\n        <div class="drag-preview-content">\n          ${o?`<img src="${o}" class="favicon" />`:""}\n          <span>${e.name}</span>\n        </div>\n      `,Object.assign(r.style,{position:"fixed",top:"-1000px",left:"-1000px",zIndex:"9999",pointerEvents:"none",backgroundColor:"white",border:"1px solid #ddd",borderRadius:"4px",padding:"8px 12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",transform:"rotate(3deg)",opacity:"0.9",fontSize:"14px",fontFamily:"inherit"}),document.body.appendChild(r),this.dragState.dragPreviewElement=r;try{t.dataTransfer.setDragImage(r,0,0)}catch(a){c.warn("设置拖拽图像失败:",a)}},setupDragListeners(){this.dragListeners.keydown=e=>{this.dragState.cancelKeys.includes(e.key)&&(e.preventDefault(),this.cancelDrag())},this.dragListeners.click=e=>{this.cancelDrag()},this.dragListeners.mousemove=e=>{const t=Math.sqrt(Math.pow(e.clientX-this.dragState.dragStartPosition.x,2)+Math.pow(e.clientY-this.dragState.dragStartPosition.y,2));t<30?this.showCancelHint():this.hideCancelHint()},document.addEventListener("keydown",this.dragListeners.keydown),document.addEventListener("click",this.dragListeners.click),document.addEventListener("mousemove",this.dragListeners.mousemove)},setupDragEndHandler(){this.dragListeners.dragend=e=>{c.log("全局拖拽结束事件"),document.querySelectorAll(".dragover").forEach((e=>{e.classList.remove("dragover")})),this.dragState.isDragging&&this.cleanupDrag(),document.removeEventListener("dragend",this.dragListeners.dragend),this.dragListeners.dragend=null},document.addEventListener("dragend",this.dragListeners.dragend)},removeDragListeners(){Object.keys(this.dragListeners).forEach((e=>{const t=this.dragListeners[e];t&&(document.removeEventListener(e,t),this.dragListeners[e]=null)}))},performReorder(){if(!this.dragState.draggedBookmark)return void c.warn("没有拖拽的书签");const e=(this.currentPage-1)*this.pageSize,t=this.dragState.targetIndex+e;c.log("执行重排序:",{bookmarkId:this.dragState.draggedBookmark.id,folderId:this.currentFolderId,targetIndex:t,pageOffset:e}),this.$store.dispatch("bookmarks/reorderBookmarks",{folderId:this.currentFolderId,bookmarkId:this.dragState.draggedBookmark.id,targetIndex:t,operationType:"drag"}),this.$message({type:"success",message:`已将 "${this.dragState.draggedBookmark.name}" 移动到新位置`,duration:2e3}),this.cleanupDrag()},cancelDrag(){c.log("取消拖拽"),this.$message({message:"拖拽已取消",type:"info",duration:1500}),this.cleanupDrag()},cleanupDrag(){if(c.log("清理拖拽状态"),this.dragState.dragPreviewElement)try{document.body.removeChild(this.dragState.dragPreviewElement)}catch(e){c.warn("移除预览元素失败:",e)}this.resetDragState(),this.removeDragListeners(),this.hideCancelHint()},resetDragState(){this.dragState={isDragging:!1,draggedBookmark:null,draggedIndex:-1,dropTargetIndex:-1,originalIndex:-1,targetIndex:-1,dropPosition:null,dragPreviewElement:null,dragStartPosition:{x:0,y:0},isInternalDrag:!1,cancelKeys:["Escape","Enter"," "]}},clearSelection(){window.getSelection&&window.getSelection().removeAllRanges()},showCancelHint(){c.log("提示: 释放鼠标可取消拖拽")},hideCancelHint(){},copyCurrentPath(){try{const e=this.folderPath.map((e=>this.safeDisplayText(e.name))).join("/");if(!e)return void this.$message.warning("当前路径为空");navigator.clipboard.writeText(e).then((()=>{this.$message({message:"路径已复制到剪贴板",type:"success",duration:1500})})).catch((e=>{c.error("复制路径失败:",e),this.$message.error("复制失败")}))}catch(e){c.error("获取当前路径失败:",e),this.$message.error("获取路径失败")}},getBookmarkPath(e){try{if(!e||!e.folderId)return"未知路径";if("root"===this.currentFolderId&&e.pathString)return this.safeDisplayText(e.pathString);const t=this.getFolderPath(e.folderId);return m.isValidArray(t)?t.map((e=>this.safeDisplayText(e.name))).join(" / "):"根目录"}catch(t){return c.error("获取书签路径失败:",t),"路径获取失败"}},copyItemPath(e){try{if(!e)return void this.$message.error("书签信息无效");const t=this.getBookmarkPath(e);if(!t)return void this.$message.warning("书签路径为空");navigator.clipboard.writeText(t).then((()=>{this.$message({message:"路径已复制到剪贴板",type:"success",duration:1500})})).catch((e=>{c.error("复制路径失败:",e),this.$message.error("复制失败")}))}catch(t){c.error("获取书签路径失败:",t),this.$message.error("获取路径失败")}},moveBookmarkUp(e){this.$store.dispatch("bookmarks/moveBookmarkUp",e)},moveBookmarkDown(e){this.$store.dispatch("bookmarks/moveBookmarkDown",e)},showToast(e,t="info"){this.$message({message:e,type:t,duration:1500})}},mounted(){this.setupLazyLoading()},updated(){this.$nextTick((()=>{this.observeFaviconElements()}))},beforeDestroy(){this.removeDragListeners(),this._faviconCache&&this._faviconCache.clear(),this._dateCache&&this._dateCache.clear(),this.cleanupLazyLoading(),this.cleanupDrag(),document.removeEventListener("keydown",this.handleEscapeKey),document.removeEventListener("click",this.handleGlobalClick),document.removeEventListener("mousemove",this.handleGlobalMouseMove),document.removeEventListener("dragend",this.handleGlobalDragEnd),document.querySelectorAll(".dragover").forEach((e=>{e.classList.remove("dragover")}))}},L=A,O=(0,v.A)(L,x,F,!1,null,"9999557c",null),C=O.exports,B=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"添加书签",visible:e.visible,width:"500px"},on:{close:e.handleClose}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"URL",prop:"url"}},[t("el-input",{model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1),t("el-form-item",{attrs:{label:"描述"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),t("el-form-item",{attrs:{label:"文件夹"}},[t("el-select",{attrs:{placeholder:"请选择文件夹"},model:{value:e.form.folderId,callback:function(t){e.$set(e.form,"folderId",t)},expression:"form.folderId"}},e._l(e.folderOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1)},$=[],M={name:"AddBookmarkDialog",props:{visible:{type:Boolean,required:!0},initialFolderId:{type:String,default:"root"}},data(){return{form:{name:"",url:"",description:"",folderId:this.initialFolderId},rules:{name:[{required:!0,message:"请输入书签名称",trigger:"blur"}],url:[{required:!0,message:"请输入URL",trigger:"blur"},{type:"url",message:"请输入正确的URL格式",trigger:"blur"}]}}},computed:{...(0,l.aH)({folders:e=>e.bookmarks.folders}),...(0,l.L8)("bookmarks",["getFolderPath"]),folderOptions(){const e=[],t=r=>{const o=this.getFolderPath(r.id),a=o.map((e=>e.name)).join(" / ");e.push({id:r.id,label:a});const i=this.folders.filter((e=>e.parentId===r.id));i.forEach(t)},r=this.folders.find((e=>"root"===e.id));return r&&t(r),e}},watch:{initialFolderId(e){this.form.folderId=e},visible(e){e&&(this.form={name:"",url:"",description:"",folderId:this.initialFolderId},this.tryGetCurrentPage())}},methods:{...(0,l.i0)("bookmarks",["addBookmark"]),handleClose(){this.$emit("update:visible",!1)},handleSubmit(){this.$refs.form.validate((e=>{if(!e)return!1;this.addBookmark(this.form),this.$emit("update:visible",!1),this.$message({type:"success",message:"添加书签成功!"})}))},tryGetCurrentPage(){try{window.chrome&&window.chrome.tabs&&window.chrome.tabs.query({active:!0,currentWindow:!0},(e=>{e&&e.length>0&&(this.form.name=e[0].title||"",this.form.url=e[0].url||"")}))}catch(e){c.log("Not in a browser extension context")}}}},R=M,P=(0,v.A)(R,B,$,!1,null,null,null),N=P.exports,H=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"导入书签",visible:e.importDialogVisible,width:"500px"},on:{close:e.closeImportDialog}},[t("div",{staticClass:"import-container"},[t("el-alert",{attrs:{title:"支持浏览器导出的书签HTML文件",type:"info",closable:!1,"show-icon":""}}),t("div",{staticClass:"upload-area"},[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"#","auto-upload":!1,"on-change":e.handleFileChange,"file-list":e.fileList,limit:1,accept:".html,.htm"}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将书签文件拖到此处，或"),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只支持HTML格式的书签文件")])])],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeImportDialog}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",disabled:!e.selectedFile},on:{click:e.handleImportBookmarks}},[e._v(" 导入 ")])],1)]),t("el-dialog",{attrs:{title:"导出书签",visible:e.exportDialogVisible,width:"500px"},on:{close:e.closeExportDialog}},[t("div",{staticClass:"export-container"},[t("el-alert",{attrs:{title:"将会导出为HTML格式，可在其他浏览器中导入",type:"info",closable:!1,"show-icon":""}}),t("div",{staticClass:"export-options"},[t("el-checkbox",{model:{value:e.exportAll,callback:function(t){e.exportAll=t},expression:"exportAll"}},[e._v("导出所有书签")]),e.exportAll?e._e():t("div",{staticClass:"folder-select"},[t("p",[e._v("选择要导出的文件夹：")]),t("el-tree",{ref:"folderTree",attrs:{data:e.folderTreeData,props:e.defaultProps,"node-key":"id","default-expanded-keys":["root"],"highlight-current":!0,"show-checkbox":""},scopedSlots:e._u([{key:"default",fn:function({node:r,data:o}){return t("span",{staticClass:"custom-tree-node"},[t("i",{class:["folder-icon",o.isExpanded?"el-icon-folder-opened":"el-icon-folder"]}),e._v(" "+e._s(r.label)+" ")])}}],null,!1,2365947337)})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeExportDialog}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleExportBookmarks}},[e._v(" 导出 ")])],1)])],1)},V=[],z=(r(3579),{name:"ImportExport",props:{importDialogVisible:{type:Boolean,default:!1},exportDialogVisible:{type:Boolean,default:!1}},data(){return{fileList:[],selectedFile:null,exportAll:!0,defaultProps:{children:"children",label:"name"}}},computed:{...(0,l.aH)({folders:e=>e.bookmarks.folders,bookmarks:e=>e.bookmarks.bookmarks}),...(0,l.L8)("bookmarks",["getFoldersByParentId","getBookmarksByFolderId"]),folderTreeData(){const e=t=>{const r=this.getFoldersByParentId(t);return r.map((t=>{const r=e(t.id);return{...t,children:r.length?r:[]}}))},t=this.folders.find((e=>"root"===e.id));return t?[{...t,children:e("root")}]:[]}},watch:{importDialogVisible(e){e||(this.fileList=[],this.selectedFile=null)},exportDialogVisible(e){e||(this.exportAll=!0)}},methods:{...(0,l.i0)("bookmarks",["importBookmarks"]),handleFileChange(e){if(!e||!e.raw)return void this.$message.error("文件信息无效");const t=["text/html","application/octet-stream"];t.includes(e.raw.type)||e.name.toLowerCase().endsWith(".html")?e.raw.size>d.MAX_FILE_SIZE?this.$message.error(`文件大小不能超过${Math.round(d.MAX_FILE_SIZE/1024/1024)}MB`):m.isSafeFileName(e.name)?this.selectedFile=e:this.$message.error("文件名包含非法字符"):this.$message.error("请选择HTML格式的书签文件")},closeImportDialog(){this.$emit("update:importDialogVisible",!1)},closeExportDialog(){this.$emit("update:exportDialogVisible",!1)},async handleImportBookmarks(){if(!this.selectedFile)return void this.$message.warning("请选择要导入的文件");const e=this.selectedFile.raw;if(d.SUPPORTED_FILE_EXTENSIONS.some((t=>e.name.toLowerCase().endsWith(t))))if(e.size>d.MAX_FILE_SIZE)this.$message.error("文件大小不能超过10MB");else try{this.$loading({text:"正在解析书签文件...",spinner:"el-icon-loading"});const t=await this.readFileAsText(e);if(!t||0===t.trim().length)throw new Error("文件内容为空");const{bookmarks:r,folders:o}=this.parseBookmarkHTML(t);if(0===r.length&&0===o.length)return void this.$message.warning("未从文件中解析出任何书签或文件夹");const a=r.filter((e=>{const t=h.validateBookmark(e);return t.isValid?!!m.isValidUrl(e.url)||(c.warn(`无效的URL: ${e.url}`),!1):(c.warn(`无效的书签: ${e.name}`,t.errors),!1)}));a.length!==r.length&&this.$message.warning(`已过滤掉 ${r.length-a.length} 个无效URL的书签`),await this.importBookmarks({bookmarks:a,folders:o.filter((e=>"root"!==e.id))}),this.$loading().close(),this.$message.success(`成功导入 ${a.length} 个书签和 ${o.length} 个文件夹`),this.$emit("update:importDialogVisible",!1)}catch(t){this.$loading().close(),c.error("导入错误",t),this.$message.error("导入失败: "+(t.message||"未知错误"))}else this.$message.error("请选择HTML格式的书签文件")},readFileAsText(e){return new Promise(((t,r)=>{const o=new FileReader;o.onload=()=>t(o.result),o.onerror=r,o.readAsText(e)}))},parseBookmarkHTML(e){try{const t=new DOMParser,r=t.parseFromString(e,"text/html"),o=r.querySelector("parsererror");if(o)throw new Error("HTML格式无效");const a=[],i=[];let s=0,n=0;const l=(e,t="root",r=0)=>{if(r>d.MAX_DEPTH.FOLDER_PARSING)return void c.warn("文件夹层级过深，停止解析");const o=Array.from(e.children);for(const h of o)try{if("DT"===h.tagName){const e=Array.from(h.children);for(const o of e)if("H3"===o.tagName){const e=this.sanitizeText(o.textContent||"未命名文件夹"),a=e.length>d.TEXT_LIMITS.FOLDER_NAME?e.substring(0,d.TEXT_LIMITS.FOLDER_NAME)+"...":e,n="imported_folder_"+s++;i.push({id:n,name:a,parentId:t});let c=o.nextElementSibling;while(c&&"DL"!==c.tagName)c=c.nextElementSibling;c&&"DL"===c.tagName&&l(c,n,r+1)}else if("A"===o.tagName){const e=o.getAttribute("href");if(e&&this.isValidUrl(e)){const r=this.sanitizeText(o.textContent||e),i=o.getAttribute("add_date"),s=r.length>d.TEXT_LIMITS.BOOKMARK_NAME?r.substring(0,d.TEXT_LIMITS.BOOKMARK_NAME)+"...":r,l=i?new Date(1e3*parseInt(i)).toISOString():(new Date).toISOString();a.push({id:"imported_bookmark_"+n++,name:s,url:e.trim(),folderId:t,createdAt:l})}else c.warn("跳过无效URL:",e)}}else"DL"===h.tagName&&l(h,t,r)}catch(m){c.warn("处理元素时出错:",m)}},m=r.querySelector("dl");if(m)l(m,"root");else{c.warn("未找到根DL元素，尝试查找其他书签结构");const e=r.querySelectorAll("a[href]");e.forEach((e=>{const t=e.getAttribute("href");if(t&&this.isValidUrl(t)){const r=this.sanitizeText(e.textContent||t);a.push({id:"imported_bookmark_"+n++,name:r.length>d.TEXT_LIMITS.BOOKMARK_NAME?r.substring(0,d.TEXT_LIMITS.BOOKMARK_NAME)+"...":r,url:t.trim(),folderId:"root",createdAt:(new Date).toISOString()})}}))}return{bookmarks:a,folders:i}}catch(t){throw c.error("解析HTML时出错:",t),new Error("解析书签文件失败: "+t.message)}},sanitizeText(e){if(m.isEmpty(e))return"";let t=u.stripHtml(e);return t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'").trim(),t=t.split("").filter((e=>{const t=e.charCodeAt(0);return t>=32&&127!==t})).join(""),t},isValidUrl(e){try{const t=new URL(e);return d.SUPPORTED_PROTOCOLS.includes(t.protocol)}catch{return!1}},handleExportBookmarks(){try{let e=[],t=[];if(this.exportAll)e=this.bookmarks,t=this.folders;else{const r=this.$refs.folderTree.getCheckedKeys();if(0===r.length)return void this.$message.warning("请选择至少一个要导出的文件夹");const o=[...r],a=e=>{const t=this.getFoldersByParentId(e);t.forEach((e=>{o.push(e.id),a(e.id)}))};r.forEach((e=>{a(e)}));const i=e=>{const t=this.folders.find((t=>t.id===e));t&&t.parentId&&"root"!==t.parentId&&(o.includes(t.parentId)||(o.push(t.parentId),i(t.parentId)))};[...o].forEach((e=>{i(e)})),o.includes("root")||o.push("root"),t=this.folders.filter((e=>o.includes(e.id))),e=this.bookmarks.filter((e=>o.includes(e.folderId)))}if(0===e.length&&0===t.length)return void this.$message.warning("没有可导出的内容");const r=this.generateBookmarkHTML(e,t),o=new Blob([r],{type:"text/html; charset=utf-8"}),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download=`bookmarks_${(new Date).toISOString().split("T")[0]}.html`,i.style.display="none",document.body.appendChild(i),i.click(),setTimeout((()=>{document.body.removeChild(i),URL.revokeObjectURL(a)}),d.DEBOUNCE_DELAY.RESOURCE_CLEANUP),this.$emit("update:exportDialogVisible",!1),this.$message.success(`导出成功：${e.length} 个书签，${t.length} 个文件夹`)}catch(e){c.error("导出错误",e),this.$message.error("导出失败: "+(e.message||"未知错误"))}},generateBookmarkHTML(e,t){try{const r={};t.forEach((e=>{r[e.id]={...e,children:[],bookmarks:[]}})),Object.keys(r).forEach((e=>{const t=r[e];null!==t.parentId&&r[t.parentId]&&r[t.parentId].children.push(t)})),e.forEach((e=>{r[e.folderId]&&r[e.folderId].bookmarks.push(e)}));let o='<!DOCTYPE NETSCAPE-Bookmark-file-1>\n\x3c!--This is an automatically generated file.\n    It will be read and overwritten.\n    DO NOT EDIT! --\x3e\n<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">\n<TITLE>Bookmarks</TITLE>\n<H1>Bookmarks</H1>\n<DL><p>\n';const a=(e,t=1)=>{if(t>d.MAX_DEPTH.HTML_GENERATION)return c.warn("文件夹层级过深，停止生成"),"";const r="    ".repeat(t),o=this.escapeHtml(e.name);let i=`${r}<DT><H3>${o}</H3>\n${r}<DL><p>\n`;return e.bookmarks.forEach((e=>{try{const t=Math.floor(new Date(e.createdAt).getTime()/1e3),o=this.escapeHtml(e.name),a=this.escapeHtml(e.url);i+=`${r}    <DT><A HREF="${a}" ADD_DATE="${t}">${o}</A>\n`}catch(t){c.warn("生成书签HTML时出错:",t)}})),e.children.forEach((e=>{i+=a(e,t+1)})),i+=`${r}</DL><p>\n`,i},i=r["root"];return i&&(i.children.forEach((e=>{o+=a(e)})),i.bookmarks.forEach((e=>{try{const t=Math.floor(new Date(e.createdAt).getTime()/1e3),r=this.escapeHtml(e.name),a=this.escapeHtml(e.url);o+=`    <DT><A HREF="${a}" ADD_DATE="${t}">${r}</A>\n`}catch(t){c.warn("生成根书签HTML时出错:",t)}}))),o+="</DL><p>",o}catch(r){throw c.error("生成HTML时出错:",r),new Error("生成导出文件失败: "+r.message)}},escapeHtml(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}}}),U=z,K=(0,v.A)(U,H,V,!1,null,"8a55dcb8",null),X=K.exports,j={name:"App",components:{Header:y,Sidebar:_,BookmarkList:C,AddBookmarkDialog:N,ImportExport:X},data(){return{currentFolderId:"root",specialMode:null,searchQuery:"",addBookmarkDialogVisible:!1,addFolderDialogVisible:!1,importDialogVisible:!1,exportDialogVisible:!1,customSortFolderDialogVisible:!1,customSortFolderFunction:"return a.name.localeCompare(b.name)",folderToSort:null,folderForm:{name:"",parentId:"root"},folderRules:{name:[{required:!0,message:"请输入文件夹名称",trigger:"blur"},{validator:this.validateFolderName,trigger:"blur"}]},searchPathsTimer:null,allFolderPathsCache:null,sidebarWidth:250,isResizing:!1,usedUndoNotifications:new Set,activeNotifications:new Map}},computed:{...(0,l.aH)({folders:e=>e.bookmarks.folders,lastOperation:e=>e.bookmarks.lastOperation}),...(0,l.L8)("bookmarks",["getFolderPath","getFoldersByParentId"]),folderOptions(){return p.safeExecute((()=>{if(!m.isValidArray(this.folders))return[];const e=[],t=r=>{if(!this.isValidFolderData(r))return;const o=this.getFolderPath(r.id);if(!m.isValidArray(o))return;const a=o.filter((e=>e&&e.name)).map((e=>u.escapeHtml(e.name))).join(" / ");e.push({id:r.id,label:a});const i=this.folders.filter((e=>e&&e.parentId===r.id&&this.isValidFolderData(e)));i.forEach(t)},r=this.folders.find((e=>e&&"root"===e.id));return r&&this.isValidFolderData(r)&&t(r),e}),"构建文件夹选项失败",[])},safeCurrentFolderId(){return m.isValidId(this.currentFolderId)?this.currentFolderId:"root"}},watch:{lastOperation(e,t){return p.safeExecute((()=>{if(e&&e.id){this.activeNotifications.forEach((e=>{e&&"function"===typeof e.close&&e.close()})),this.activeNotifications.clear(),"add"!==e.type&&"delete"!==e.type&&"move"!==e.type&&"update"!==e.type&&"import"!==e.type&&"reset"!==e.type||(this.allFolderPathsCache=null);const t=e.id,r=u.escapeHtml(e.description||"操作"),o=this.$notify({title:"操作完成",message:`${r}已完成，点击可撤销此操作`,duration:5e3,type:"info",onClick:()=>{this.usedUndoNotifications.has(t)?this.$message.warning("该操作已经被撤销过了"):(this.usedUndoNotifications.add(t),this.activeNotifications.delete(t),this.undoLastOperation(),o&&"function"===typeof o.close&&o.close())}});this.activeNotifications.set(t,o)}}),"操作通知处理失败")}},methods:{...(0,l.i0)("bookmarks",["addFolder","checkInvalidBookmarks","checkDuplicateBookmarks","sortBookmarksCustom","undoOperation","resetAllBookmarks","resetAllFolders","resetAll"]),isValidFolderData(e){return e&&"object"===typeof e&&m.isValidId(e.id)&&"string"===typeof e.name&&e.name.length<=d.TEXT_LIMITS.FOLDER_NAME},validateFolderName(e,t,r){return p.safeExecute((()=>{if(m.isEmpty(t))return void r(new Error("文件夹名称不能为空"));if(t.length>d.TEXT_LIMITS.FOLDER_NAME)return void r(new Error(`文件夹名称不能超过${d.TEXT_LIMITS.FOLDER_NAME}个字符`));const e=["<",">",'"',"'","&","/","\\"];e.some((e=>t.includes(e)))?r(new Error("文件夹名称包含非法字符")):r()}),"文件夹名称验证失败",(()=>r(new Error("验证失败"))))},validateAndSanitizeSearch(e){return m.isEmpty(e)?"":(e.length>d.TEXT_LIMITS.BOOKMARK_NAME&&(this.$message.warning(`搜索内容已截断到${d.TEXT_LIMITS.BOOKMARK_NAME}个字符`),e=e.substring(0,d.TEXT_LIMITS.BOOKMARK_NAME)),u.sanitizeInput(e))},validateAndSanitizeCustomSort(e){if(m.isEmpty(e))throw new Error("排序函数不能为空");let t=e.trim();const r=/^\s*\(\s*\w+\s*,\s*\w+\s*\)\s*=>\s*(.+)$/,o=t.match(r);if(o){const e=o[1].trim();t=e.startsWith("return ")||e.includes("return ")?e:`return ${e}`}t.startsWith("return ")||t.includes("return ")||(t=`return ${t}`);const a=["eval","Function","setTimeout","setInterval","document","window","global","process","require","import","fetch","XMLHttpRequest"];if(a.some((e=>t.includes(e))))throw new Error("排序函数包含不安全的内容");if(t.length>1e3)throw new Error("排序函数过长");try{new Function("a","b",t)}catch(i){throw new Error(`排序函数语法错误: ${i.message}`)}return u.sanitizeInput(t)},handleFolderSelected(e){return p.safeExecute((()=>{m.isValidId(e)?(this.currentFolderId=e,this.specialMode=null):this.$message.error("无效的文件夹ID")}),"文件夹选择失败")},handleSpecialFolderSelected(e){return p.safeExecute((()=>{const t=["invalid","duplicate"];t.includes(e)?this.specialMode=e:this.$message.error("无效的特殊文件夹模式")}),"特殊文件夹选择失败")},handleSearch(e){return p.safeExecute((()=>{const t=this.validateAndSanitizeSearch(e);if(this.searchQuery=t,m.isEmpty(t))return;const r=t.toLowerCase().trim(),o=this.$store.state.bookmarks.bookmarks;if(!m.isValidArray(o))return;const a=o.filter((e=>{if(!e||"object"!==typeof e)return!1;const t=(e.name||"").toLowerCase(),o=(e.url||"").toLowerCase(),a=(e.description||"").toLowerCase();return t.includes(r)||o.includes(r)||a.includes(r)})),i=a.map((e=>{const t=this.getFolderPath(e.folderId),r=m.isValidArray(t)?t.map((e=>u.escapeHtml(e.name||""))).join(" / "):"";return{...e,folderPath:t,pathString:r}}));if(i.length>0){this.$notify({title:"搜索结果",message:`找到 ${i.length} 个匹配的书签`,type:"success",duration:3e3});const e=this.generateSearchResultsHtml(i);this.$confirm(e,"搜索结果",{dangerouslyUseHTMLString:!0,confirmButtonText:"关闭",showCancelButton:!1,closeOnClickModal:!0,center:!0,customClass:"search-results-dialog"}).catch((()=>{})),this.showSearchResultsDialog(i)}else this.$message({type:"info",message:`未找到匹配"${u.escapeHtml(e)}"的书签`})}),"搜索处理失败")},showAddBookmarkDialog(e){return p.safeExecute((()=>{e&&m.isValidId(e)&&(this.currentFolderId=e),this.addBookmarkDialogVisible=!0}),"显示添加书签对话框失败")},showAddFolderDialog(){return p.safeExecute((()=>{this.folderForm={name:"",parentId:this.currentFolderId},this.addFolderDialogVisible=!0}),"显示添加文件夹对话框失败")},createFolder(){return p.safeExecute((()=>{this.$refs.folderForm.validate((e=>{if(!e)return!1;{const e=u.sanitizeInput(this.folderForm.name);if(e.length>d.TEXT_LIMITS.FOLDER_NAME)return void this.$message.warning(`文件夹名称不能超过${d.TEXT_LIMITS.FOLDER_NAME}个字符`);this.addFolder({...this.folderForm,name:e}),this.addFolderDialogVisible=!1,this.$message({type:"success",message:"创建文件夹成功!"})}}))}),"创建文件夹失败")},showImportDialog(){return p.safeExecute((()=>{this.importDialogVisible=!0}),"显示导入对话框失败")},showExportDialog(){return p.safeExecute((()=>{this.exportDialogVisible=!0}),"显示导出对话框失败")},async checkInvalidBookmarks(){return p.safeExecuteAsync((async()=>{this.$message({message:"正在检测无效书签，请稍候...",type:"info"});const e=await this.$store.dispatch("bookmarks/checkInvalidBookmarks");m.isValidArray(e)&&e.length>0?(this.$message({message:`检测到 ${e.length} 个无效书签`,type:"warning"}),this.handleSpecialFolderSelected("invalid")):this.$message({message:"未检测到无效书签",type:"success"})}),"检测无效书签失败")},checkDuplicateBookmarks(){return p.safeExecute((()=>{const e=this.$store.dispatch("bookmarks/checkDuplicateBookmarks");m.isValidArray(e)&&e.length>0?(this.$message({message:`检测到 ${e.length} 个重复书签`,type:"warning"}),this.handleSpecialFolderSelected("duplicate")):this.$message({message:"未检测到重复书签",type:"success"})}),"检测重复书签失败")},showCustomSortFolderDialog(e){return p.safeExecute((()=>{m.isValidId(e)?(this.folderToSort=e,this.customSortFolderDialogVisible=!0):this.$message.error("无效的文件夹ID")}),"显示自定义排序对话框失败")},applyCustomSortFolder(){return p.safeExecute((()=>{if(this.folderToSort)try{const e=this.validateAndSanitizeCustomSort(this.customSortFolderFunction);this.sortBookmarksCustom({folderId:this.folderToSort,sortFunctionString:e}),this.customSortFolderDialogVisible=!1,this.$message({type:"success",message:"排序成功!"})}catch(e){this.$message({type:"error",message:e.message||"排序函数格式错误"})}else this.$message.warning("请先选择要排序的文件夹")}),"应用自定义排序失败")},undoLastOperation(){return p.safeExecute((()=>{this.undoOperation(),this.allFolderPathsCache=null,this.$message({type:"success",message:"操作已撤销"})}),"撤销操作失败")},showResetConfirmation(){this.$confirm("确定要清除所有收藏夹和书签吗？此操作无法撤销。","确认清除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.activeNotifications.forEach((e=>{e&&"function"===typeof e.close&&e.close()})),this.activeNotifications.clear(),this.usedUndoNotifications.clear(),this.resetAll().then((()=>{this.currentFolderId="root",this.specialMode=null,this.allFolderPathsCache=null,this.searchQuery="",this.$message({type:"success",message:"所有收藏夹和书签已清除"}),this.$nextTick((()=>{this.$forceUpdate()}))})).catch((e=>{this.$message.error("清除失败: "+e.message)}))})).catch((()=>{}))},navigateByPath(e){if(!e)return;const t=e.split("/").map((e=>e.trim())).filter((e=>e));if(0===t.length)return;let r="root",o=!0;for(let a=0;a<t.length;a++){const e=t[a];if(0===a&&"收藏夹根目录"===e)continue;const i=this.getFoldersByParentId(r),s=i.find((t=>t.name===e));if(!s){o=!1,this.$message.warning(`找不到路径中的文件夹"${e}"`);break}r=s.id}o&&(this.handleFolderSelected(r),this.$message.success("已跳转到指定路径"))},searchPaths(e,t){e?(this.searchPathsTimer&&clearTimeout(this.searchPathsTimer),this.searchPathsTimer=setTimeout((()=>{const r=e.toLowerCase(),o=[];if(!this.allFolderPathsCache){this.allFolderPathsCache=[];const e=(t,r=0)=>{if(r>d.MAX_DEPTH.FOLDER_PARSING||this.allFolderPathsCache.length>d.CACHE_LIMITS.MAX_PATH_CACHE_SIZE)return void c.warn("递归深度或路径数量达到限制，停止构建路径缓存");const o=this.getFolderPath(t),a=o.map((e=>e.name)).join(" / ");this.allFolderPathsCache.push({id:t,pathString:a,path:o});const i=this.getFoldersByParentId(t);i.forEach((t=>e(t.id,r+1)))};e("root",0)}for(let e=0;e<this.allFolderPathsCache.length;e++){const t=this.allFolderPathsCache[e];if(t.pathString.toLowerCase().includes(r)&&(o.push(t),o.length>=d.PAGINATION.DEFAULT_SEARCH_RESULTS))break}t(o)}),d.DEBOUNCE_DELAY.SEARCH)):t([])},initResize(e){this.isResizing=!0,document.addEventListener("mousemove",this.handleResize),document.addEventListener("mouseup",this.stopResize),e.preventDefault()},handleResize(e){if(!this.isResizing)return;const t=e.clientX;t<d.LAYOUT.SIDEBAR_MIN_WIDTH?this.sidebarWidth=d.LAYOUT.SIDEBAR_MIN_WIDTH:t>window.innerWidth-d.LAYOUT.SIDEBAR_MAX_OFFSET?this.sidebarWidth=window.innerWidth-d.LAYOUT.SIDEBAR_MAX_OFFSET:this.sidebarWidth=t},stopResize(){this.isResizing=!1,document.removeEventListener("mousemove",this.handleResize),document.removeEventListener("mouseup",this.stopResize)},generateSearchResultsHtml(e){const t=e=>{const t=document.createElement("div");return t.textContent=e,t.innerHTML},r=e.map((e=>{const r=t(e.name),o=t(e.url),a=t(e.pathString);return`\n          <li style="margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">\n            <div><b>${r}</b></div>\n            <div style="color: #999; font-size: 12px;">${o}</div>\n            <div style="color: #67C23A; font-size: 12px; margin-top: 5px;">\n              <i class="el-icon-folder"></i> ${a}\n            </div>\n          </li>\n        `})).join("");return`\n        <div style="max-height: 300px; overflow-y: auto;">\n          <h3>找到 ${e.length} 个匹配的书签</h3>\n          <ul style="list-style: none; padding: 0;">\n            ${r}\n          </ul>\n        </div>\n      `},handleSearchResultInteraction(e){e.map((e=>({text:`${e.name} - 跳转到文件夹`,callback:()=>this.handleFolderSelected(e.folderId)})))},showSearchResultsDialog(e){e.map((e=>({name:e.name,url:e.url,path:e.pathString,folderId:e.folderId})));this.$msgbox({title:`搜索结果 (${e.length}条)`,message:`找到了${e.length}个匹配的书签，您可以在书签列表中查看详细信息。`,showCancelButton:!1,confirmButtonText:"确定",type:"info"})}},beforeDestroy(){this.activeNotifications.forEach((e=>{e&&"function"===typeof e.close&&e.close()})),this.activeNotifications.clear(),this.usedUndoNotifications.clear(),this.searchPathsTimer&&(clearTimeout(this.searchPathsTimer),this.searchPathsTimer=null),document.removeEventListener("mousemove",this.handleResize),document.removeEventListener("mouseup",this.stopResize),window.removeEventListener("jump-to-folder",this.handleJumpToFolder),this.allFolderPathsCache=null}},G=j,Z=(0,v.A)(G,s,n,!1,null,null,null),W=Z.exports,Y=r(7779);r(8237);const q=()=>Math.random().toString(36).substr(2,9),Q=e=>{e._cachedBookmarksWithPath=null,e._lastBookmarkCount=0},J=e=>p.safeExecute((()=>{if(!e||"object"!==typeof e)throw new Error("书签数据必须是对象");const t=h.validateBookmark(e);if(!t.isValid)throw new Error(t.errors.join(", "));return{...e,name:u.sanitizeInput(e.name||""),url:e.url?u.sanitizeUrl(e.url):"",description:e.description?u.sanitizeInput(e.description):"",folderId:m.isValidId(e.folderId)?e.folderId:"root"}}),"书签数据验证失败",null),ee=e=>p.safeExecute((()=>{if(!e||"object"!==typeof e)throw new Error("文件夹数据必须是对象");const t=h.validateFolder(e);if(!t.isValid)throw new Error(t.errors.join(", "));return{...e,name:u.sanitizeInput(e.name||""),parentId:m.isValidId(e.parentId)?e.parentId:"root"}}),"文件夹数据验证失败",null);class te{constructor(){this.operations=new Map}register(e,t,r){this.operations.set(e,{undoFn:t,redoFn:r})}undo(e,t){const r=this.operations.get(e.type);return r&&r.undoFn?r.undoFn(e.data,t):"function"===typeof e.undo?e.undo():void c.warn(`未找到操作类型 ${e.type} 的撤销处理器`)}redo(e,t){const r=this.operations.get(e.type);return r&&r.redoFn?r.redoFn(e.data,t):"function"===typeof e.redo?e.redo():void c.warn(`未找到操作类型 ${e.type} 的重做处理器`)}}const re=new te,oe={bookmarks:[],folders:[{id:"root",name:"收藏夹根目录",parentId:null,isExpanded:!0}],selectedItems:[],invalidBookmarks:[],duplicateBookmarks:[],history:[],currentHistoryIndex:-1,lastOperation:null,undoneOperationIds:new Set,_cachedBookmarksWithPath:null,_lastBookmarkCount:0},ae={getFoldersByParentId:e=>t=>e.folders.filter((e=>e.parentId===t)),getAllChildFolders:e=>t=>{const r=[],o=t=>{const a=e.folders.filter((e=>e.parentId===t));a.forEach((e=>{r.push(e),o(e.id)}))};return o(t),r},getBookmarksByFolderId:e=>t=>e.bookmarks.filter((e=>e.folderId===t)).sort(((e,t)=>(e.order||0)-(t.order||0))),getAllBookmarks:e=>e.bookmarks,getAllBookmarksWithPath:(e,t)=>(e._cachedBookmarksWithPath&&e._lastBookmarkCount===e.bookmarks.length||(e._cachedBookmarksWithPath=e.bookmarks.map((e=>{const r=t.getFolderPath(e.folderId),o=r.map((e=>e.name)).join(" / ");return{...e,folderPath:r,pathString:o}})),e._lastBookmarkCount=e.bookmarks.length),e._cachedBookmarksWithPath),getInvalidBookmarks:e=>e.invalidBookmarks,getDuplicateBookmarks:e=>e.duplicateBookmarks,getSelectedItems:e=>e.selectedItems,getFolderPath:e=>t=>{const r=[];let o=e.folders.find((e=>e.id===t));while(o){if(r.unshift(o),null===o.parentId)break;o=e.folders.find((e=>e.id===o.parentId))}return r}},ie={CLEAR_CACHE(e){e._cachedBookmarksWithPath=null,e._lastBookmarkCount=0},ADD_BOOKMARK(e,t){return p.safeExecute((()=>{const r=J(t);if(!r)throw new Error("无效的书签数据");const o=e.bookmarks.filter((e=>e.folderId===r.folderId)).reduce(((e,t)=>Math.max(e,t.order||0)),-1),a={id:q(),createdAt:(new Date).toISOString(),order:o+1,...r};return e.bookmarks.push(a),Q(e),a}),"添加书签失败")},UPDATE_BOOKMARK(e,{id:t,updates:r}){return p.safeExecute((()=>{if(!m.isValidId(t))throw new Error("无效的书签ID");if(!r||"object"!==typeof r)throw new Error("更新数据必须是对象");const o=e.bookmarks.findIndex((e=>e.id===t));if(-1===o)throw new Error("未找到指定书签");const a={...e.bookmarks[o],...r},i=J(a);if(!i)throw new Error("更新数据验证失败");const s=["name","url","description","folderId","order","isExpanded"],n={};return s.forEach((e=>{e in r&&(n[e]=i[e])})),e.bookmarks[o]={...e.bookmarks[o],...n},Q(e),e.bookmarks[o]}),"更新书签失败")},DELETE_BOOKMARK(e,t){return p.safeExecute((()=>{if(!m.isValidId(t))throw new Error("无效的书签ID");const r=e.bookmarks.length;return e.bookmarks=e.bookmarks.filter((e=>e.id!==t)),Q(e),r!==e.bookmarks.length}),"删除书签失败",!1)},DELETE_BOOKMARKS_BULK(e,t){return p.safeExecute((()=>{if(!m.isValidArray(t))throw new Error("ID列表必须是数组");const r=t.filter((e=>m.isValidId(e)));if(0===r.length)throw new Error("没有有效的书签ID");const o=e.bookmarks.length;return e.bookmarks=e.bookmarks.filter((e=>!r.includes(e.id))),Q(e),o-e.bookmarks.length}),"批量删除书签失败",0)},ADD_FOLDER(e,t){return p.safeExecute((()=>{const r=ee(t);if(!r)throw new Error("无效的文件夹数据");const o={id:q(),isExpanded:!1,createdAt:(new Date).toISOString(),...r};return e.folders.push(o),Q(e),o}),"添加文件夹失败")},UPDATE_FOLDER(e,{id:t,updates:r}){return p.safeExecute((()=>{if(!m.isValidId(t))throw new Error("无效的文件夹ID");if(!r||"object"!==typeof r)throw new Error("更新数据必须是对象");const o=e.folders.findIndex((e=>e.id===t));if(-1===o)throw new Error("未找到指定文件夹");const a={...e.folders[o],...r};if("name"in r){const e=ee(a);if(!e)throw new Error("文件夹名称验证失败");r.name=e.name}const i=["name","parentId","isExpanded","order"],s={};return i.forEach((e=>{if(e in r){if("parentId"===e&&!m.isValidId(r[e]))throw new Error("无效的父文件夹ID");s[e]=r[e]}})),e.folders[o]={...e.folders[o],...s},Q(e),e.folders[o]}),"更新文件夹失败")},DELETE_FOLDER(e,t){const r=[],o=t=>{const a=e.folders.filter((e=>e.parentId===t));a.forEach((e=>{r.push(e.id),o(e.id)}))};o(t),e.bookmarks=e.bookmarks.filter((e=>e.folderId!==t&&!r.includes(e.folderId))),e.folders=e.folders.filter((e=>!r.includes(e.id))),e.folders=e.folders.filter((e=>e.id!==t)),Q(e)},MOVE_ITEMS(e,{itemIds:t,targetFolderId:r,itemType:o}){"bookmark"===o?(t.forEach((t=>{const o=e.bookmarks.findIndex((e=>e.id===t));-1!==o&&(e.bookmarks[o].folderId=r)})),localStorage.setItem("bookmarks",JSON.stringify(e.bookmarks))):"folder"===o&&(t.forEach((t=>{let o=e.folders.find((e=>e.id===r));while(o&&null!==o.parentId){if(o.id===t)return;o=e.folders.find((e=>e.id===o.parentId))}const a=e.folders.findIndex((e=>e.id===t));-1!==a&&(e.folders[a].parentId=r)})),localStorage.setItem("folders",JSON.stringify(e.folders))),Q(e)},SET_SELECTED_ITEMS(e,t){e.selectedItems=t},CLEAR_SELECTED_ITEMS(e){e.selectedItems=[]},IMPORT_BOOKMARKS(e,{bookmarks:t,folders:r}){const o=new Set(e.bookmarks.map((e=>e.url))),a=t.filter((e=>!o.has(e.url)));e.bookmarks=[...e.bookmarks,...a];const i=new Set(e.folders.map((e=>`${e.name}|${e.parentId}`))),s=r.filter((e=>!i.has(`${e.name}|${e.parentId}`)));e.folders=[...e.folders,...s],Q(e)},SET_INVALID_BOOKMARKS(e,t){e.invalidBookmarks=t},SET_DUPLICATE_BOOKMARKS(e,t){e.duplicateBookmarks=t},TOGGLE_FOLDER_EXPANSION(e,t){const r=e.folders.findIndex((e=>e.id===t));-1!==r&&(e.folders[r].isExpanded=!e.folders[r].isExpanded)},SORT_BOOKMARKS(e,{folderId:t,sortFunction:r}){const o=e.bookmarks.filter((e=>e.folderId===t));if(0===o.length)return;const a=[...o].sort(r);a.forEach(((t,r)=>{const o=e.bookmarks.findIndex((e=>e.id===t.id));-1!==o&&(e.bookmarks[o].order=r)}))},SORT_FOLDERS(e,{parentId:t,sortFunction:r}){const o=e.folders.filter((e=>e.parentId===t)),a=e.folders.filter((e=>e.parentId!==t)),i=[...o].sort(r);e.folders=[...a,...i]},ADD_OPERATION(e,t){const r={...t,id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now()};e.currentHistoryIndex<e.history.length-1&&(e.history=e.history.slice(0,e.currentHistoryIndex+1)),e.history.push(r),e.currentHistoryIndex=e.history.length-1,e.lastOperation=r},UNDO_OPERATION(e){if(e.history.length>0&&e.currentHistoryIndex>=0){const t=e.history[e.currentHistoryIndex];if(t){if(e.undoneOperationIds.has(t.id))return void c.warn("操作已被撤销过:",t.id);e.undoneOperationIds.add(t.id),"function"===typeof t.undo&&t.undo(),e.currentHistoryIndex--,e.lastOperation=null}}},REDO_OPERATION(e){if(e.currentHistoryIndex<e.history.length-1){e.currentHistoryIndex++;const t=e.history[e.currentHistoryIndex];t&&(e.undoneOperationIds.delete(t.id),"function"===typeof t.redo&&t.redo())}},UPDATE_HISTORY_INDEX(e,t){e.currentHistoryIndex=t},INIT_UNDONE_OPERATION_IDS(e){e.undoneOperationIds=new Set},RESET_FOLDERS(e){e.folders=[{id:"root",name:"收藏夹根目录",parentId:null,isExpanded:!0}],Q(e)},RESET_BOOKMARKS(e){e.bookmarks=[],e.selectedItems=[],e.invalidBookmarks=[],e.duplicateBookmarks=[],Q(e)},RESET_HISTORY(e){e.history=[],e.currentHistoryIndex=-1,e.lastOperation=null,e.undoneOperationIds.clear()},REORDER_BOOKMARKS(e,{folderId:t,bookmarkId:r,targetIndex:o}){const a=e.bookmarks.filter((e=>e.folderId===t));a.forEach(((e,t)=>{void 0===e.order&&(e.order=t)})),a.sort(((e,t)=>(e.order||0)-(t.order||0)));const i=a.findIndex((e=>e.id===r));if(-1===i||i===o)return;const[s]=a.splice(i,1);a.splice(o,0,s),a.forEach(((t,r)=>{const o=e.bookmarks.findIndex((e=>e.id===t.id));-1!==o&&(e.bookmarks[o].order=r)})),Q(e),localStorage.setItem("bookmarks",JSON.stringify(e.bookmarks))}},se={initOperationManager(){re.register("moveItems",((e,t)=>{const{itemIds:r,itemType:o,originalState:a}=e;"bookmark"===o?r.forEach((e=>{a[e]&&t("moveItems",{itemIds:[e],targetFolderId:a[e].folderId,itemType:"bookmark",skipHistory:!0})})):"folder"===o&&r.forEach((e=>{a[e]&&t("moveItems",{itemIds:[e],targetFolderId:a[e].parentId,itemType:"folder",skipHistory:!0})}))}),((e,t)=>{t("moveItems",{itemIds:e.itemIds,targetFolderId:e.targetFolderId,itemType:e.itemType,skipHistory:!0})})),re.register("reorderBookmarks",((e,t)=>{void 0!==e.originalIndex&&-1!==e.originalIndex&&t("reorderBookmarks",{folderId:e.folderId,bookmarkId:e.bookmarkId,targetIndex:e.originalIndex,skipHistory:!0})}),((e,t)=>{t("reorderBookmarks",{folderId:e.folderId,bookmarkId:e.bookmarkId,targetIndex:e.targetIndex,skipHistory:!0})}))},initializeBookmarkOrder({commit:e,state:t,dispatch:r}){r("initOperationManager");const o={};t.bookmarks.forEach((e=>{o[e.folderId]||(o[e.folderId]=[]),o[e.folderId].push(e)})),Object.keys(o).forEach((t=>{const r=o[t];r.forEach(((t,r)=>{void 0===t.order&&e("UPDATE_BOOKMARK",{id:t.id,updates:{order:r}})}))}))},addBookmark({commit:e},t){return e("ADD_BOOKMARK",t),Promise.resolve()},updateBookmark({commit:e},{id:t,updates:r}){return e("UPDATE_BOOKMARK",{id:t,updates:r}),Promise.resolve()},deleteBookmark({commit:e},t){return e("DELETE_BOOKMARK",t),Promise.resolve()},deleteBookmarksBulk({commit:e},t){return e("DELETE_BOOKMARKS_BULK",t),Promise.resolve()},addFolder({commit:e},t){return e("ADD_FOLDER",t),Promise.resolve()},updateFolder({commit:e},{id:t,updates:r}){return e("UPDATE_FOLDER",{id:t,updates:r}),Promise.resolve()},deleteFolder({commit:e},t){return e("DELETE_FOLDER",t),Promise.resolve()},moveItems({commit:e,dispatch:t,state:r},{itemIds:o,targetFolderId:a,itemType:i,skipHistory:s=!1}){const n={};if("bookmark"===i?o.forEach((e=>{const t=r.bookmarks.find((t=>t.id===e));t&&(n[e]={folderId:t.folderId})})):"folder"===i&&o.forEach((e=>{const t=r.folders.find((t=>t.id===e));t&&(n[e]={parentId:t.parentId})})),e("MOVE_ITEMS",{itemIds:o,targetFolderId:a,itemType:i}),!s){const r={type:"moveItems",description:"移动"+("bookmark"===i?"书签":"文件夹"),data:{itemIds:o,targetFolderId:a,itemType:i,originalState:n},undo:()=>{"bookmark"===i?o.forEach((t=>{n[t]&&e("MOVE_ITEMS",{itemIds:[t],targetFolderId:n[t].folderId,itemType:"bookmark"})})):"folder"===i&&o.forEach((t=>{n[t]&&e("MOVE_ITEMS",{itemIds:[t],targetFolderId:n[t].parentId,itemType:"folder"})}))},redo:()=>{e("MOVE_ITEMS",{itemIds:o,targetFolderId:a,itemType:i})}};t("addToHistory",r)}return Promise.resolve()},setSelectedItems({commit:e},t){return e("SET_SELECTED_ITEMS",t),Promise.resolve()},clearSelectedItems({commit:e}){return e("CLEAR_SELECTED_ITEMS"),Promise.resolve()},importBookmarks({commit:e},{bookmarks:t,folders:r}){return e("IMPORT_BOOKMARKS",{bookmarks:t,folders:r}),Promise.resolve()},async checkInvalidBookmarks({commit:e,state:t}){const r=[],o=10,a=[...t.bookmarks];for(let i=0;i<a.length;i+=o){const e=a.slice(i,i+o),t=await Promise.allSettled(e.map((async e=>{try{const t=new AbortController,r=setTimeout((()=>t.abort()),3e3),o=await fetch(e.url,{method:"HEAD",signal:t.signal});return clearTimeout(r),o.ok?{status:"valid",bookmark:e}:{status:"invalid",bookmark:e}}catch(t){return{status:"invalid",bookmark:e}}})));t.forEach((e=>{"fulfilled"===e.status&&"invalid"===e.value.status?r.push(e.value.bookmark):e.status})),i+o<a.length&&await new Promise((e=>setTimeout(e,100)))}return e("SET_INVALID_BOOKMARKS",r),r},checkDuplicateBookmarks({commit:e,state:t}){const r={},o=[];return t.bookmarks.forEach((e=>{r[e.url]?o.push(e):r[e.url]=!0})),e("SET_DUPLICATE_BOOKMARKS",o),o},toggleFolderExpansion({commit:e},t){return e("TOGGLE_FOLDER_EXPANSION",t),Promise.resolve()},sortBookmarksByName({commit:e,state:t},r){const o=t.bookmarks.filter((e=>e.folderId===r)),a=o.map((e=>({id:e.id,index:t.bookmarks.findIndex((t=>t.id===e.id))}))),i=(e,t)=>e.name.localeCompare(t.name);e("SORT_BOOKMARKS",{folderId:r,sortFunction:i});const s=t.folders.find((e=>e.id===r)),n=s?s.name:"文件夹",l={type:"sort",description:`按名称排序文件夹"${n}"中的书签`,data:{folderId:r,originalOrder:a},timestamp:(new Date).toISOString()};return e("ADD_OPERATION",l),Promise.resolve()},sortBookmarksByUrl({commit:e,state:t},r){const o=t.bookmarks.filter((e=>e.folderId===r)),a=o.map((e=>({id:e.id,index:t.bookmarks.findIndex((t=>t.id===e.id))}))),i=(e,t)=>e.url.localeCompare(t.url);e("SORT_BOOKMARKS",{folderId:r,sortFunction:i});const s=t.folders.find((e=>e.id===r)),n=s?s.name:"文件夹",l={type:"sort",description:`按URL排序文件夹"${n}"中的书签`,data:{folderId:r,originalOrder:a},timestamp:(new Date).toISOString()};return e("ADD_OPERATION",l),Promise.resolve()},sortBookmarksByDate({commit:e,state:t},r){const o=t.bookmarks.filter((e=>e.folderId===r)),a=o.map((e=>({id:e.id,index:t.bookmarks.findIndex((t=>t.id===e.id))}))),i=(e,t)=>new Date(t.createdAt)-new Date(e.createdAt);e("SORT_BOOKMARKS",{folderId:r,sortFunction:i});const s=t.folders.find((e=>e.id===r)),n=s?s.name:"文件夹",l={type:"sort",description:`按创建日期排序文件夹"${n}"中的书签`,data:{folderId:r,originalOrder:a},timestamp:(new Date).toISOString()};return e("ADD_OPERATION",l),Promise.resolve()},sortBookmarksCustom({commit:e,state:t},{folderId:r,sortFunctionString:o}){try{const a=new Function("a","b",o),i=t.bookmarks.filter((e=>e.folderId===r)),s=i.map((e=>({id:e.id,index:t.bookmarks.findIndex((t=>t.id===e.id))})));e("SORT_BOOKMARKS",{folderId:r,sortFunction:a});const n=t.folders.find((e=>e.id===r)),l=n?n.name:"文件夹",d={type:"sort",description:`自定义排序文件夹"${l}"中的书签`,data:{folderId:r,originalOrder:s},timestamp:(new Date).toISOString()};return e("ADD_OPERATION",d),Promise.resolve()}catch(a){return c.error("Invalid sort function:",a),Promise.reject(a)}},sortFoldersByName({commit:e},t){const r=(e,t)=>e.name.localeCompare(t.name);return e("SORT_FOLDERS",{parentId:t,sortFunction:r}),Promise.resolve()},addOperation({commit:e},t){return e("ADD_OPERATION",t),Promise.resolve()},undoOperation({commit:e,dispatch:t}){return e("UNDO_OPERATION",{dispatch:t}),Promise.resolve()},redoOperation({commit:e,dispatch:t}){return e("REDO_OPERATION",{dispatch:t}),Promise.resolve()},resetAllFolders({commit:e}){return e("RESET_FOLDERS"),Promise.resolve()},resetAllBookmarks({commit:e}){return e("RESET_BOOKMARKS"),Promise.resolve()},resetHistory({commit:e}){return e("RESET_HISTORY"),Promise.resolve()},resetAll({dispatch:e}){return Promise.all([e("resetAllBookmarks"),e("resetAllFolders"),e("resetHistory")])},reorderBookmarks({commit:e,dispatch:t,state:r},{folderId:o,bookmarkId:a,targetIndex:i,operationType:s="reorder",skipHistory:n=!1}){const l=r.bookmarks.find((e=>e.id===a)),d=l?l.name:"书签";let c;switch(s){case"up":c=`上移书签"${d}"`;break;case"down":c=`下移书签"${d}"`;break;case"drag":c=`拖拽调整书签"${d}"的位置`;break;default:c=`调整书签"${d}"的位置`;break}let m=-1;if(!n){const e=r.bookmarks.filter((e=>e.folderId===o));e.forEach(((e,t)=>{void 0===e.order&&(e.order=t)})),e.sort(((e,t)=>(e.order||0)-(t.order||0))),m=e.findIndex((e=>e.id===a))}if(e("REORDER_BOOKMARKS",{folderId:o,bookmarkId:a,targetIndex:i}),!n){const e={type:"reorderBookmarks",description:c,data:{folderId:o,bookmarkId:a,targetIndex:i,originalIndex:m},undo:()=>{void 0!==m&&-1!==m&&t("reorderBookmarks",{folderId:o,bookmarkId:a,targetIndex:m,skipHistory:!0})},redo:()=>{t("reorderBookmarks",{folderId:o,bookmarkId:a,targetIndex:i,skipHistory:!0})}};t("addToHistory",e)}},moveBookmarkUp({state:e,dispatch:t},r){const o=e.bookmarks.find((e=>e.id===r));if(!o)return;const a=o.folderId,i=e.bookmarks.filter((e=>e.folderId===a));i.forEach(((e,t)=>{void 0===e.order&&(e.order=t)})),i.sort(((e,t)=>(e.order||0)-(t.order||0)));const s=i.findIndex((e=>e.id===r));s<=0||t("reorderBookmarks",{folderId:a,bookmarkId:r,targetIndex:s-1,operationType:"up"})},moveBookmarkDown({state:e,dispatch:t},r){const o=e.bookmarks.find((e=>e.id===r));if(!o)return;const a=o.folderId,i=e.bookmarks.filter((e=>e.folderId===a));i.forEach(((e,t)=>{void 0===e.order&&(e.order=t)})),i.sort(((e,t)=>(e.order||0)-(t.order||0)));const s=i.findIndex((e=>e.id===r));-1===s||s>=i.length-1||t("reorderBookmarks",{folderId:a,bookmarkId:r,targetIndex:s+1,operationType:"down"})},applySavedHistory({dispatch:e},{type:t,data:r}){return re.undo({type:t,data:r},e)},addToHistory({commit:e},t){e("ADD_OPERATION",t)},undo({commit:e,dispatch:t,state:r}){if(r.currentHistoryIndex>=0){const o=r.history[r.currentHistoryIndex];o&&(re.undo(o,t),e("UPDATE_HISTORY_INDEX",r.currentHistoryIndex-1))}},redo({commit:e,dispatch:t,state:r}){if(r.currentHistoryIndex<r.history.length-1){const o=r.currentHistoryIndex+1,a=r.history[o];a&&(re.redo(a,t),e("UPDATE_HISTORY_INDEX",o))}}};var ne={namespaced:!0,state:oe,getters:ae,mutations:ie,actions:se};i["default"].use(l.Ay);var le=new l.Ay.Store({modules:{bookmarks:ne},plugins:[(0,Y.A)({key:"bookmark-manager",paths:["bookmarks"],rehydrated(e){!e.state.bookmarks.undoneOperationIds||e.state.bookmarks.undoneOperationIds instanceof Set||e.commit("bookmarks/INIT_UNDONE_OPERATION_IDS")}})]}),de=r(9135),ce=r.n(de);i["default"].config.productionTip=!1,i["default"].config.devtools=!1,i["default"].config.debug=!1,i["default"].config.silent=!0,i["default"].use(a()),i["default"].component("vue-draggable",ce()),new i["default"]({store:le,render:e=>e(W),async mounted(){try{await this.$nextTick(),await this.$store.dispatch("bookmarks/initializeBookmarkOrder")}catch(e){c.error("初始化书签顺序失败:",e)}},errorCaptured(e,t,r){return c.error("全局错误捕获:",e,r),!1}}).$mount("#app")}},t={};function r(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(t,o,a,i){if(!o){var s=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],i=e[c][2];for(var n=!0,l=0;l<o.length;l++)(!1&i||s>=i)&&Object.keys(r.O).every((function(e){return r.O[e](o[l])}))?o.splice(l--,1):(n=!1,i<s&&(s=i));if(n){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[o,a,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,i,s=o[0],n=o[1],l=o[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(a in n)r.o(n,a)&&(r.m[a]=n[a]);if(l)var c=l(r)}for(t&&t(o);d<s.length;d++)i=s[d],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(c)},o=self["webpackChunkvue2_bookmark_manager"]=self["webpackChunkvue2_bookmark_manager"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[952,96],(function(){return r(4108)}));o=r.O(o)})();